(()=>{"use strict";var e={3705:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ZOrderOperation=t.isRawSendXHRResponse=t.MermaidDiagramType=t.GetLLMContextType=t.GetItemsAtSearchType=t.GetDocumentChunksType=t.HashAlgorithmEnum=t.commandTitles=void 0;const n=i(6930);var r,o,s,a,l,c;t.commandTitles=new Map([["aci","AddCardIntegration"],["adfm","AddDiagramFromMermaid"],["adft","AddDiagramFromText"],["alta","AddLineTextArea"],["ami","AddMenuItem"],["asd","AddShapeData"],["asi","AddSpreadsheetIntegration"],["atc","AddTableColumn"],["atr","AddTableRow"],["a","Alert"],["av","AnimateViewport"],["adi","AwaitDataSourceImport"],["ai","AwaitImport"],["b","Bootstrap"],["ceps","CanEditPackageSettings"],["cdc","CancelDragBlockToCanvas"],["c","Confirm"],["cb","CreateBlock"],["cc","CreateCollection"],["cds","CreateDataSource"],["cde","CreateDocumentElement"],["cg","CreateGroup"],["cl","CreateLine"],["cp","CreatePage"],["die","DataItemExists"],["dde","DeleteDocumentElement"],["di","DeleteItem"],["dp","DeletePage"],["dsd","DeleteShapeData"],["dtc","DeleteTableColumn"],["dtr","DeleteTableRow"],["d","Download"],["dpm","DragPointerMove"],["dpu","DragPointerUp"],["dis","DuplicateItems"],["ee","ElementExists"],["ef","ExecuteFormula"],["fas","FindAvailableSpace"],["fbe","FireBeaconEvent"],["gcl","GetConnectedLines"],["gcp","GetCurrentPage"],["gcs","GetCustomShape"],["gdif","GetDataItemField"],["gdap","GetDocumentAccessPermission"],["gdc","GetDocumentChunks"],["gdid","GetDocumentId"],["get","GetElementType"],["gec","GetEnvironmentConfig"],["gip","GetItemPageId"],["gia","GetItemsAt"],["llm","GetLLMContextFromItems"],["goci","GetOAuthClientId"],["got","GetOAuthToken"],["gps","GetPackageSettings"],["gpr","GetProduct"],["gp","GetProperty"],["grk","GetReferenceKey"],["grlp","GetRelativeLinePosition"],["gs","GetSelection"],["gsd","GetShapeData"],["gsvg","GetSvg"],["gts","GetTextStyle"],["guid","GetUserId"],["gvr","GetVisibleRect"],["hm","HideModal"],["hp","HidePanel"],["hac","HookAllChanges"],["hci","HookCreateItems"],["hdi","HookDeleteItems"],["hs","HookSelection"],["hte","HookTextEdit"],["ic","ImportCards"],["il","ImportLinks"],["imp","ImportPage"],["k","KillExtension"],["lb","ListBlocks"],["lcf","ListCollectionFields"],["lc","ListCollections"],["ldi","ListDataItems"],["lds","ListDataSources"],["lde","ListDocumentElements"],["lg","ListGroups"],["ll","ListLines"],["lp","ListPages"],["lpr","ListProperties"],["lrk","ListReferenceKeys"],["lsd","ListShapeData"],["lta","ListTextAreas"],["lbc","LoadBlockClasses"],["log","LogForTestCase"],["mt","MeasureText"],["oi","OffsetItems"],["pdi","PatchDataItems"],["p","Prompt"],["rp","RegisterPanel"],["ru","RegisterUnfurl"],["r","ReloadExtension"],["aoauth","SendAsyncOAuthRequest"],["oauth","SendOAuthRequest"],["suim","SendUIMessage"],["xhr","SendXHR"],["scp","SetCurrentPage"],["sps","SetPackageSettings"],["sp","SetProperty"],["srk","SetReferenceKey"],["ss","SetSelection"],["ssd","SetShapeData"],["sts","SetTextStyle"],["sm","ShowModal"],["spsm","ShowPackageSettingsModal"],["spn","ShowPanel"],["sleep","SleepForTestCase"],["sdc","StartDragBlockToCanvas"],["pdf","StartPDFUploadRequest"],["throw","ThrowForTestCase"],["tauth","TriggerAuthFlow"],["uac","UnhookAllChanges"],["uci","UnhookCreateItems"],["udi","UnhookDeleteItems"],["us","UnhookSelection"],["ute","UnhookTextEdit"],["wm","WithMutex"],["wsa","WithSilentActions"],["z","ZOrder"]]),function(e){e.sha256="SHA256"}(r||(t.HashAlgorithmEnum=r={})),function(e){e[e.Geographic=0]="Geographic",e[e.Container=1]="Container"}(o||(t.GetDocumentChunksType=o={})),function(e){e[e.PossiblyOverlapping=0]="PossiblyOverlapping",e[e.Overlapping=1]="Overlapping",e[e.Contained=2]="Contained"}(s||(t.GetItemsAtSearchType=s={})),function(e){e[e.Relational=1]="Relational",e[e.PlainText=2]="PlainText",e[e.RelationalWithoutExpansion=3]="RelationalWithoutExpansion"}(a||(t.GetLLMContextType=a={})),function(e){e.FLOWCHART="flowchart"}(l||(t.MermaidDiagramType=l={})),t.isRawSendXHRResponse=function(e){return(0,n.isString)(e.url)&&(0,n.isString)(e.t)&&(0,n.isNumber)(e.s)&&(0,n.isObject)(e.h)},function(e){e[e.UP=1]="UP",e[e.TOP=2]="TOP",e[e.DOWN=3]="DOWN",e[e.BOTTOM=4]="BOTTOM"}(c||(t.ZOrderOperation=c={}))},9148:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.encodeBase64=t.decodeBase64=void 0;const i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n=[];for(let e=0;e<65;e++)n[i.charCodeAt(e)]=e;t.decodeBase64=function(e){if((e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"")).length%4!=0)throw new Error("Invalid base64 input; length must be a multiple of 4");let t=e.length/4*3;e.endsWith("==")?t-=2:e.endsWith("=")&&(t-=1);const i=new Uint8Array(t);let r=0;for(let o=0;o<t;o+=3){const t=n[e.charCodeAt(r++)],s=n[e.charCodeAt(r++)],a=n[e.charCodeAt(r++)],l=n[e.charCodeAt(r++)];if(void 0===t||void 0===s||void 0===a||void 0===l)throw new Error("char code to encoded int contains an undefined index");i[o]=t<<2|s>>4,64!=a&&(i[o+1]=(15&s)<<4|a>>2),64!=l&&(i[o+2]=(3&a)<<6|l)}return i},t.encodeBase64=function(e){const t=Math.floor(e.length/3),n=4*Math.ceil(e.length/3),r=new Array(n);let o=0,s=0;for(let n=0;n<t;n++){const t=e[o++],n=e[o++],a=e[o++];if(void 0===t||void 0===n||void 0===a)throw new Error("byteArray contains undefined indexes");const l=t>>2,c=(3&t)<<4|n>>4,d=(15&n)<<2|a>>6,u=63&a;r[s++]=i[l],r[s++]=i[c],r[s++]=i[d],r[s++]=i[u]}if(o<e.length){const t=e[o++],n=o<e.length,a=n?e[o++]:0,l=t>>2,c=(3&t)<<4|a>>4,d=n?(15&a)<<2:64;r[s++]=i[l],r[s++]=i[c],r[s++]=i[d],r[s++]="="}return r.join("")}},2203:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LucidCardFields=t.StatusValues=t.deserializeLucidCardFieldDisplaySettings=t.serializeLucidCardFieldDisplaySettings=t.isOnClickHandlerKey=t.OnClickHandlerKeys=t.isFieldDisplayType=t.FieldDisplayType=void 0;const n=i(7660);var r,o,s,a;!function(e){e.BasicTextBadge="BasicTextBadge",e.InitializedString="InitializedString",e.StandardEstimation="StandardEstimation",e.ImageBadge="ImageBadge",e.SquareImageBadge="SquareImageBadge",e.DateBadge="DateBadge",e.UserProfile="UserProfile"}(r||(t.FieldDisplayType=r={})),t.isFieldDisplayType=(0,n.enumValidator)(r),function(e){e.BasicEditPanel="BasicEditPanel",e.OpenBrowserWindow="OpenBrowserWindow",e.CustomEditAction="CustomEditAction"}(o||(t.OnClickHandlerKeys=o={})),t.isOnClickHandlerKey=(0,n.enumValidator)(o),t.serializeLucidCardFieldDisplaySettings=function(e){return{StencilConfig:e.stencilConfig&&{getterKey:e.stencilConfig.displayType,f:e.stencilConfig.valueFormula,t:e.stencilConfig.tooltipFormula,l:e.stencilConfig.linkFormula,fg:e.stencilConfig.foregroundColor,bg:e.stencilConfig.backgroundColor,h:e.stencilConfig.horizontalPosition,v:e.stencilConfig.verticalPosition,onClickHandlerKey:e.stencilConfig.onClickHandlerKey,imageBadgeSettings:e.stencilConfig.imageBadgeSettings,textBadgeSettings:e.stencilConfig.textBadgeSettings}}},t.deserializeLucidCardFieldDisplaySettings=function(e){return{stencilConfig:e.StencilConfig&&{displayType:e.StencilConfig.getterKey,valueFormula:e.StencilConfig.f,tooltipFormula:e.StencilConfig.t,linkFormula:e.StencilConfig.l,foregroundColor:e.StencilConfig.fg,backgroundColor:e.StencilConfig.bg,horizontalPosition:e.StencilConfig.h,verticalPosition:e.StencilConfig.v,onClickHandlerKey:e.StencilConfig.onClickHandlerKey,imageBadgeSettings:e.StencilConfig.imageBadgeSettings,textBadgeSettings:e.StencilConfig.textBadgeSettings}}},function(e){e.New="New",e.Todo="To Do",e.InProgress="In Progress",e.Done="Done",e.NotDoing="Not Doing",e.Blocked="Blocked"}(s||(t.StatusValues=s={})),function(e){e.Title="Title",e.Description="Description",e.Assignee="Assignee",e.Estimate="Estimate",e.Status="Status",e.StartTime="StartTime",e.EndTime="EndTime"}(a||(t.LucidCardFields=a={}))},7702:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deserializeCardIntegrationConfig=t.serializeCardIntegrationConfig=void 0;const n=i(2203);t.serializeCardIntegrationConfig=function(e){return{cc:{f:e.cardConfig.fieldNames,fd:e.cardConfig.fieldDisplaySettings?[...e.cardConfig.fieldDisplaySettings].map((([e,t])=>[e,(0,n.serializeLucidCardFieldDisplaySettings)(t)])):void 0,fs:e.cardConfig.fieldStyles?[...e.cardConfig.fieldStyles]:void 0},cdpc:{f:e.cardDetailsPanelConfig.fields.map((e=>({n:e.name,l:e.locked})))}}},t.deserializeCardIntegrationConfig=function(e){return{cardConfig:{fieldNames:e.cc.f,fieldStyles:e.cc.fs?new Map(e.cc.fs):void 0,fieldDisplaySettings:e.cc.fd?new Map(e.cc.fd.map((([e,t])=>[e,(0,n.deserializeLucidCardFieldDisplaySettings)(t)]))):void 0},cardDetailsPanelConfig:{fields:e.cdpc.f.map((e=>({name:e.n,locked:e.l})))}}}},6096:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deserializeCardFieldArrayDefinition=t.deserializeCardFieldDefinition=t.isSerializedExtensionCardFieldDefinition=t.isSerializedFieldOptions=t.isSerializedFieldOption=t.deserializeFieldOption=t.serializeCardFieldArrayDefinition=t.serializeCardFieldDefinition=t.serializeCardFieldOption=void 0;const n=i(7700),r=i(6930),o=i(2939),s=i(9098),a=i(1346),l=i(7660);function c(e){return{l:e.label,v:e.value,i:e.iconUrl}}function d(e){var t;return Object.assign(Object.assign({},(0,n.serializeFieldDefinition)(e)),{l:e.label,def:e.default,d:e.description,op:(0,r.isString)(e.options)?e.options:null===(t=e.options)||void 0===t?void 0:t.map(c),s:e.search})}function u(e){return{label:e.l,value:e.v,iconUrl:e.i}}function h(e){var t;return Object.assign(Object.assign({},(0,n.parseFieldDefinition)(e)),{label:e.l,description:e.d,default:e.def,options:(0,r.isString)(e.op)?e.op:null===(t=e.op)||void 0===t?void 0:t.map(u),search:e.s})}t.serializeCardFieldOption=c,t.serializeCardFieldDefinition=d,t.serializeCardFieldArrayDefinition=function(e){return e.map(d)},t.deserializeFieldOption=u,t.isSerializedFieldOption=(0,l.objectValidator)({l:r.isString,v:a.isSerializedFieldType,i:(0,l.option)(r.isString)}),t.isSerializedFieldOptions=(0,l.arrayValidator)(t.isSerializedFieldOption),t.isSerializedExtensionCardFieldDefinition=(0,l.objectValidator)({Name:r.isString,Type:o.isSerializedFieldTypeDefinition,Constraints:(0,l.option)((0,l.arrayValidator)(s.isSerializedFieldConstraint)),l:r.isString,d:(0,l.option)(r.isString),def:(0,l.option)(a.isSerializedFieldType),op:(0,l.option)((0,l.either)(r.isString,(0,l.arrayValidator)(t.isSerializedFieldOption))),s:(0,l.option)(r.isString)}),t.deserializeCardFieldDefinition=h,t.deserializeCardFieldArrayDefinition=function(e){return e.map(h)}},4761:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LucidCardIntegration=void 0,t.LucidCardIntegration=class{constructor(e){this.client=e}showCardImport(e){return this.client.sendCommand("ic",e)}}},4438:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LucidCardIntegrationCustomImportModal=void 0;const n=i(7999);class r extends n.Modal{constructor(e,t,i){super(e,t),this.cardIntegrationLabel=i}createCards(e,t){return this.client.sendCommand("ca",{cid:this.cardIntegrationLabel,coid:e,pks:t})}}t.LucidCardIntegrationCustomImportModal=r},4710:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LucidCardIntegrationRegistry=void 0;const n=i(3659),r=i(7807),o=i(7702),s=i(6096),a=i(4438);class l{static nextHookName(){return"__lucidcard__hook"+l.nextHookId++}static registerFieldOptionsCallback(e,t){const i=l.nextHookName();return e.registerAction(i,(async({i:e})=>(await t(new Map(e))).map((e=>(0,s.serializeCardFieldOption)(e))))),i}static registerFieldSearchCallback(e,t){const i=l.nextHookName();return e.registerAction(i,(async({i:e,s:i})=>(await t(i,new Map(e))).map((e=>(0,s.serializeCardFieldOption)(e))))),i}static addCardIntegration(e,t){const i=l.nextHookName();let c;e.registerAction(i,(async i=>{const n=new r.DataSourceProxy(i.d,e);return await t.fieldConfiguration.getAllFields(n)}));const d=t.fieldConfiguration.onSelectedFieldsChange;d&&(c=l.nextHookName(),e.registerAction(c,(async t=>{const i=new r.DataSourceProxy(t.ds,e);await d(i,t.sf)})));const u=l.nextHookName();let h;e.registerAction(u,(async i=>{const n=new r.DataSourceProxy(i.d,e);return(0,o.serializeCardIntegrationConfig)(await t.getDefaultConfig(n))})),t.showIntro&&(h=l.nextHookName(),e.registerAction(h,t.showIntro));const p={n:t.label,dcn:t.dataConnectorName,il:t.itemLabel,isl:t.itemsLabel,u:t.iconUrl,ts:t.textStyle,fc:{gf:i,osfc:c,fvsc:t.fieldConfiguration.fieldValueSearchCallbacks?[...t.fieldConfiguration.fieldValueSearchCallbacks.entries()]:void 0},gdc:u,i:h};if(t.importModal){const i=t.importModal;i instanceof a.LucidCardIntegrationCustomImportModal?(p.cim={sh:l.nextHookName()},e.registerAction(p.cim.sh,(()=>i.show()))):(p.im={gsf:l.nextHookName(),s:l.nextHookName(),i:l.nextHookName(),os:i.onSetup?l.nextHookName():void 0},e.registerAction(p.im.gsf,(async({s:e})=>{const t=await i.getSearchFields(new Map(e));return(0,s.serializeCardFieldArrayDefinition)(t)})),e.registerAction(p.im.s,(async({s:e})=>{const t=await i.search(new Map(e));return{d:(0,n.serializeCollectionDefinition)(t.data),f:(0,s.serializeCardFieldArrayDefinition)(t.fields),m:t.partialImportMetadata&&{cid:t.partialImportMetadata.collectionId,sid:t.partialImportMetadata.syncDataSourceId}}})),e.registerAction(p.im.i,(async({pks:e,s:t})=>{const n=await i.import(e,new Map(t));return{c:n.collection.id,pks:n.primaryKeys}})),p.im.os&&e.registerAction(p.im.os,(async()=>{var e;await(null===(e=i.onSetup)||void 0===e?void 0:e.call(i))})))}if(t.addCard){const i=t.addCard;p.ac={gif:l.nextHookName(),cc:l.nextHookName()},e.registerAction(p.ac.gif,(async({i:e})=>{const t=await i.getInputFields(new Map(e));return(0,s.serializeCardFieldArrayDefinition)(t)})),e.registerAction(p.ac.cc,(async({i:e})=>{const t=await i.createCardData(new Map(e));return{c:t.collection.id,pk:t.primaryKey}}))}e.sendCommand("aci",p)}}t.LucidCardIntegrationRegistry=l,l.nextHookId=0},6930:(e,t)=>{function i(e){return null!=e}function n(e){return"number"==typeof e}function r(e){return"function"==typeof e}function o(e){const t=typeof e;return"object"==t&&null!=e||"function"==t}function s(e){const t=typeof e;return"object"==t&&null!=e||"function"==t}function a(e){return Array.isArray(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.isInstanceOf=t.isLiteral=t.isPromise=t.isUnknown=t.isAny=t.isEmptyOrNullishObject=t.isAtLeastLength=t.isExactLength=t.isTypedArray=t.isArray=t.isRecord=t.isObjectUnsafer=t.isObjectUnsafe=t.isObject=t.isFunction=t.isInfinite=t.isInt=t.isNumber=t.isBoolean=t.isString=t.isNullish=t.isDefAndNotNull=t.isVoid=t.isUndefined=t.isNull=t.isDef=void 0,t.isDef=function(e){return void 0!==e},t.isNull=function(e){return null===e},t.isUndefined=function(e){return void 0===e},t.isVoid=function(e){return void 0===e},t.isDefAndNotNull=i,t.isNullish=function(e){return null==e},t.isString=function(e){return"string"==typeof e},t.isBoolean=function(e){return"boolean"==typeof e},t.isNumber=n,t.isInt=function(e){return n(e)&&isFinite(e)&&e%1==0},t.isInfinite=function(e){return n(e)&&!isNaN(e)&&!isFinite(e)},t.isFunction=r,t.isObject=o,t.isObjectUnsafe=s,t.isObjectUnsafer=function(e){const t=typeof e;return"object"==t&&null!=e||"function"==t},t.isRecord=function(e){return function(t){return o(t)&&Object.values(t).every(e)}},t.isArray=a,t.isTypedArray=function(e){return function(t){return a(t)&&t.every(e)}},t.isExactLength=function(e,t){return e.length===t},t.isAtLeastLength=function(e,t){return e.length>=t},t.isEmptyOrNullishObject=function(e){return!(e&&"object"==typeof e&&Object.keys(e).find((t=>i(e[t]))))},t.isAny=function(e){return!0},t.isUnknown=function(e){return!0},t.isPromise=function(e){return s(e)&&r(e.then)&&r(e.catch)},t.isLiteral=function(e){return t=>t===e},t.isInstanceOf=function(e){return t=>t instanceof e}},7933:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.alphabet=void 0,t.alphabet=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"]},639:(e,t)=>{var i;Object.defineProperty(t,"__esModule",{value:!0}),t.DataSourceType=void 0,function(e){e[e.DeprecatedGoogleSheets=0]="DeprecatedGoogleSheets",e[e.DeprecatedCSV=1]="DeprecatedCSV",e[e.DeprecatedExcel=2]="DeprecatedExcel",e[e.Salesforce=3]="Salesforce",e[e.Generator=4]="Generator",e[e.DataService=5]="DataService",e[e.ForeignKeyOverride=7]="ForeignKeyOverride",e[e.Extension=8]="Extension",e[e.Unknown=9]="Unknown"}(i||(t.DataSourceType=i={}))},1270:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeSerializedImportedDataSource=t.makeSerializedImportedCollection=t.MetadataPK=t.makeNameReadablyUnique=t.normalizeName=t.alphabetize=void 0;const n=i(9697),r=i(6930),o=i(6798),s=i(7933),a=i(639),l=i(3460),c=i(9002),d=new Map;function u(e){const t=d.get(e);if(null!=t)return t;const i=function(e){return null==e||e<0?"":e<s.alphabet.length?s.alphabet[e]:u(Math.floor(e/s.alphabet.length)-1)+u(e%s.alphabet.length)}(e);return d.set(e,i),i}function h(e){return e.trim().toLowerCase()}t.alphabetize=u,t.normalizeName=h;const p=/(.*) \(([0-9]+)\)$/;function m(e,t,i=h){if(!t.has(i(e)))return e;const n=p.exec(e);let o=1;n&&(0,r.isString)(n[1])&&(0,r.isString)(n[2])&&(e=n[1],o=Number(n[2])+1);let s=e;do{s=e+` (${o})`,o++}while(t.has(i(s)));return s}function y(e,t,i,n){return{Name:t+"|"+e,Schema:n,Items:i}}function f(e,i,n,r,o=!1){const s={};return i.forEach(((i,a)=>{if(o||a!==r){const r={};for(const[e,t]of Object.entries(i)){const i=n.get(e);i&&(r[i]=t)}const l=e[a];if(o&&Object.keys(r).length>0){const e=`${l}`;r[t.MetadataPK]=e,s[`${JSON.stringify(e)}`]=r}else o||(s[l]=r)}})),s}t.makeNameReadablyUnique=m,t.MetadataPK="__PK__",t.makeSerializedImportedCollection=function(e,i,n,s,a,c,d){var p;const{sheetSchema:g,oldToNewFields:S}=function(e,i,n){var o,s;const a=null!==(o=null==n?void 0:n.headerRow)&&void 0!==o?o:-1,c=a>=0?i[a]:void 0,d=c&&e.map(((e,t)=>{var i;const n=`${null!==(i=c[e])&&void 0!==i?i:""}`;return""===n.trim()?u(t):n})),p=null!=d?d:e,y=[],f=new Map,g=new Set([h(t.MetadataPK)]);p.forEach(((t,i)=>{const n=m(t,g);g.add(h(n)),y.push({Name:n,Type:l.SpreadSheetPossibleDataTypes}),f.set(e[i],n)}));const S=(null!==(s=null==n?void 0:n.primaryKey)&&void 0!==s?s:[]).map((e=>f.get(e))).filter(r.isDefAndNotNull);return{sheetSchema:{Fields:y,PrimaryKey:S},oldToNewFields:f}}(i,n,d),C=function(e,t,i){if(!i||0===i.primaryKey.length)return t.map(((e,t)=>`${t+1}`));const n=i.primaryKey,r=n.map((t=>{var i;return null!==(i=e.get(t))&&void 0!==i?i:t})),o=r.slice().sort().map((e=>n[r.indexOf(e)])),s=new Set;return t.map((e=>{const t=o.map((t=>e[t])),i=JSON.stringify(t),n=i.slice(1,i.length-1);let r=n,a=-1;for(;s.has(r);)r=`${n},${++a}`;return s.add(r),r}))}(S,n,d),T=null!==(p=null==d?void 0:d.headerRow)&&void 0!==p?p:-1,b={};if(b.ItemOrder=function(e,t,i){const n={};let r=0;for(let t=0;t<e.length;t++){const o=e[t];t!==i&&(r++,n[`${r}`]={Key:`${o}`,Order:r})}return y("ItemOrder",t,n,{Fields:[{Name:"Key",Type:o.ScalarFieldTypeEnum.STRING},{Name:"Order",Type:o.ScalarFieldTypeEnum.NUMBER}],PrimaryKey:["Order"]})}(C,e,T),T>-1&&T<n.length){const t=n[T],i=C[T];b.HeaderRowMetadata=function(e,t,i,n,r){const o={};for(const[e,n]of Object.entries(t)){const t=i.get(e);t&&(o[t]=n)}return y("HeaderRowMetadata",n,{[e]:o},r)}(i,t,S,e,g)}if(c){const i=[{Name:t.MetadataPK,Type:o.ScalarFieldTypeEnum.STRING}];g.Fields.forEach((e=>i.push({Name:e.Name,Type:[o.ScalarFieldTypeEnum.STRING,o.ScalarFieldTypeEnum.NULL]})));const n={Fields:i,PrimaryKey:[t.MetadataPK]};for(const[t,i]of Object.entries(c))b[t]=y(t,e,f(C,i,S,T,!0),n)}return{Name:e,Schema:g,Items:f(C,n,S,T),UpstreamConfig:s,Metadata:b,DataIsPartial:a}},t.makeSerializedImportedDataSource=function(e,t,i){return{Properties:{Name:t,UpstreamConfig:{SourceType:a.DataSourceType.DataService,UpdateType:c.UpstreamUpdateType.EVENTPULL,SourceConfig:{spreadsheetId:e,UpdateFilterType:n.DataUpdateFilterType.CurrentCollectionUpdates}}},Collections:i}}},2546:(e,t)=>{var i;Object.defineProperty(t,"__esModule",{value:!0}),t.MetadataTypes=void 0,function(e){e.Format="Format",e.FillColor="FillColor",e.TextColor="TextColor",e.Comment="Comment",e.Formula="Formula",e.HeaderRowMetadata="HeaderRowMetadata",e.ExternalLink="ExternalLink"}(i||(t.MetadataTypes=i={}))},6732:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isSerializedDataSourceProperties=t.isSerializedSourceForeignKey=void 0;const n=i(6930),r=i(7660),o=i(4827);t.isSerializedSourceForeignKey=(0,r.objectValidator)({Id:n.isString,SourceFields:(0,r.arrayValidator)(n.isString),RelationshipType:n.isString}),t.isSerializedDataSourceProperties=(0,r.strictObjectValidator)({Name:n.isString,UpstreamConfig:(0,r.nullableOption)(o.isSerializedUpstreamConfig),SourceForeignKeys:(0,r.nullableOption)((0,r.arrayValidator)(t.isSerializedSourceForeignKey))})},9309:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isSerializedImportedDataSource=t.isSerializedImportedCollection=t.isSerializedImportedMetadataCollection=void 0;const n=i(6930),r=i(7660),o=i(5271),s=i(4196),a=i(6732);t.isSerializedImportedMetadataCollection=(0,r.strictObjectValidator)({Name:n.isString,Schema:s.isSerializedSchema,Items:o.isSerializedDataItems}),t.isSerializedImportedCollection=(0,r.strictObjectValidator)({Name:n.isString,Schema:s.isSerializedSchema,Items:o.isSerializedDataItems,UpstreamConfig:n.isObject,Metadata:(0,n.isRecord)(t.isSerializedImportedMetadataCollection),DataIsPartial:(0,r.option)(r.isTrue)}),t.isSerializedImportedDataSource=(0,r.strictObjectValidator)({Properties:a.isSerializedDataSourceProperties,Collections:(0,n.isTypedArray)(t.isSerializedImportedCollection)})},4827:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isSerializedUpstreamConfig=void 0;const n=i(6930),r=i(7660),o=i(639),s=i(4945),a=i(9002);t.isSerializedUpstreamConfig=(0,r.strictObjectValidator)({SourceType:(0,r.enumValidator)(o.DataSourceType),UpdateType:(0,r.enumValidator)(a.UpstreamUpdateType),PatchType:(0,r.nullableOption)((0,r.enumValidator)(s.UpstreamPatchType)),SourceConfig:n.isObject})},3460:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SpreadSheetPossibleDataTypes=void 0;const n=i(6798);t.SpreadSheetPossibleDataTypes=[n.ScalarFieldTypeEnum.BOOLEAN,n.ScalarFieldTypeEnum.NUMBER,n.ScalarFieldTypeEnum.STRING,n.ScalarFieldTypeEnum.NULL,n.ScalarFieldTypeEnum.CURRENCY,n.ScalarFieldTypeEnum.DATE,n.ScalarFieldTypeEnum.DATEONLY,n.ScalarFieldTypeEnum.TIMEONLY,n.ScalarFieldTypeEnum.COLOR]},7457:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isSerializedSourceConfig=t.deserializeUpstreamConfig=t.serializeUpstreamConfig=void 0;const n=i(6930);t.serializeUpstreamConfig=function(e){return{SourceType:e.dataSourceType,UpdateType:e.updateType,PatchType:e.patchType,SourceConfig:e.sourceConfig}},t.deserializeUpstreamConfig=function(e){return{dataSourceType:e.SourceType,updateType:e.UpdateType,patchType:null===e.PatchType?void 0:e.PatchType,sourceConfig:e.SourceConfig}},t.isSerializedSourceConfig=function(e){return(0,n.isObject)(e)}},4945:(e,t)=>{var i;Object.defineProperty(t,"__esModule",{value:!0}),t.UpstreamPatchType=void 0,function(e){e[e.NONE=0]="NONE",e[e.MANUAL=2]="MANUAL",e[e.AUTO=3]="AUTO"}(i||(t.UpstreamPatchType=i={}))},9002:(e,t)=>{var i;Object.defineProperty(t,"__esModule",{value:!0}),t.UpstreamUpdateType=void 0,function(e){e[e.NONE=0]="NONE",e[e.PULL=1]="PULL",e[e.USER=2]="USER",e[e.EVENTPULL=3]="EVENTPULL"}(i||(t.UpstreamUpdateType=i={}))},5463:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FormattedPrimaryKey=t.declareSchema=void 0,t.declareSchema=function({primaryKey:e,fields:t}){const n=new i(...e);return{example:t,array:Object.entries(t).map((([e,{type:t,constraints:i,mapping:n}])=>{return{name:e,type:(r=t,Array.isArray(r)?t.slice():t),constraints:i,mapping:n};var r})),primaryKey:n,fromItemsSparse:e=>new Map(e.map((e=>[n.forItem(e),e]))),fromItems:e=>new Map(e.map((e=>[n.forItem(e),e])))}};class i{constructor(...e){this.elements=[...e].sort()}forItem(e){return i.serializeList(this.elements.map((t=>e[t])))}static serializeList(e){let t=JSON.stringify(e);return t=t.substring(1,t.length-1),t}}t.FormattedPrimaryKey=i},1116:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isSerializedBaseFieldTypeDefinition=t.deserializeBaseFieldTypeDefinition=t.serializeBaseFieldTypeDefinition=t.isBaseFieldTypeDefinition=void 0;const n=i(6930),r=i(1069),o=i(4925),s=i(3581),a=i(6730),l=i(6798);function c(e){return(0,n.isDefAndNotNull)(l.ScalarFieldTypeEnum[e])||(0,s.isSerializedLiteralFieldType)(e)||(0,r.isSerializedCollectionEnumFieldType)(e)||(0,o.isSerializedFieldTypeArray)(e,c)||(0,a.isSerializedNDimensionalFieldTypeArray)(e)}t.isBaseFieldTypeDefinition=function(e){return(0,l.isScalarFieldTypeEnum)(e)||(0,s.isLiteralFieldType)(e)||e instanceof o.FieldTypeArray||e instanceof a.NDimensionalFieldTypeArray||(0,r.isCollectionEnumFieldType)(e)},t.serializeBaseFieldTypeDefinition=function(e){return e instanceof s.LiteralFieldType||e instanceof o.FieldTypeArray||e instanceof a.NDimensionalFieldTypeArray||e instanceof r.CollectionEnumFieldType?e.toJSON():e},t.deserializeBaseFieldTypeDefinition=function(e){return(0,s.isSerializedLiteralFieldType)(e)?(0,s.deserializeLiteralFieldType)(e):(0,r.isSerializedCollectionEnumFieldType)(e)?(0,r.deserializeCollectionEnumFieldType)(e):(0,o.isSerializedFieldTypeArray)(e,c)?(0,o.deserializeFieldTypeArray)(e):(0,a.isSerializedNDimensionalFieldTypeArray)(e)?(0,a.deserializeNDimensionalFieldTypeArray)(e):e},t.isSerializedBaseFieldTypeDefinition=c},1069:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isSerializedCollectionEnumFieldType=t.deserializeCollectionEnumFieldType=t.isCollectionEnumFieldType=t.CollectionEnumFieldType=t.isCollectionEnumFieldNames=t.CollectionEnumFieldNames=t.CollectionEnumFieldTypeKey=void 0;const n=i(6930),r=i(7660);var o;t.CollectionEnumFieldTypeKey="COLLECTION_ENUM",function(e){e.Name="name",e.Id="id",e.Description="description",e.Color="color",e.IconUrl="iconUrl"}(o||(t.CollectionEnumFieldNames=o={})),t.isCollectionEnumFieldNames=(0,r.enumValidator)(o);class s{constructor(e){this.collectionId=e}toJSON(){return{[t.CollectionEnumFieldTypeKey]:this.collectionId}}}t.CollectionEnumFieldType=s,s.PRIMARY_KEY=o.Id,t.isCollectionEnumFieldType=e=>e instanceof s,t.deserializeCollectionEnumFieldType=function(e){return new s(e[t.CollectionEnumFieldTypeKey])},t.isSerializedCollectionEnumFieldType=function(e){return(0,n.isObjectUnsafe)(e)&&(0,n.isString)(e[t.CollectionEnumFieldTypeKey])}},4925:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deserializeFieldTypeArray=t.isSerializedFieldTypeArray=t.FieldTypeArray=t.BaseFieldTypeArray=void 0;const n=i(6930),r=i(1069),o=i(3581),s=i(6798);class a{constructor(e){this.validTypesArray=e}getInnerTypes(){return this.validTypesArray}getInnerNonArrayTypes(){return this.validTypesArray.filter((e=>!(e instanceof a)))}toJSON(){return{ND:!1,validTypes:this.validTypesArray.map((e=>this.serializeType(e)))}}}t.BaseFieldTypeArray=a;class l extends a{serializeType(e){return(0,s.isScalarFieldTypeEnum)(e)?e:e.toJSON()}}t.FieldTypeArray=l,t.isSerializedFieldTypeArray=function(e,t){return(0,n.isObjectUnsafe)(e)&&(0,n.isBoolean)(e.ND)&&!1===e.ND&&(0,n.isArray)(e.validTypes)&&e.validTypes.every((e=>t(e)))},t.deserializeFieldTypeArray=function e(t){return new l(t.validTypes.map((t=>(0,o.isSerializedLiteralFieldType)(t)?(0,o.deserializeLiteralFieldType)(t):(0,r.isSerializedCollectionEnumFieldType)(t)?(0,r.deserializeCollectionEnumFieldType)(t):(0,n.isObject)(t)?e(t):t)))}},2939:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isSerializedFieldTypeDefinition=t.deserializeFieldTypeDefinition=t.serializeFieldTypeDefinition=t.fieldTypesEqual=void 0;const n=i(6930),r=i(1116),o=i(1069),s=i(4925),a=i(3581),l=i(6730);t.fieldTypesEqual=function e(t,i,r=!0){if(t===i)return!0;if((0,a.isLiteralFieldType)(t)&&(0,a.isLiteralFieldType)(i))return t.getLiteral()===i.getLiteral();if((0,o.isCollectionEnumFieldType)(t)&&(0,o.isCollectionEnumFieldType)(i))return!r||t.collectionId===i.collectionId;t=(0,n.isArray)(t)?t:[t],i=(0,n.isArray)(i)?i:[i];const c=new Set(t),d=new Set(i);if(c.size!==d.size)return!1;for(const i of d)if(!c.has(i))if((0,a.isLiteralFieldType)(i)){if(!t.some((t=>(0,a.isLiteralFieldType)(t)&&e(t,i))))return!1}else if(i instanceof s.FieldTypeArray){if(!t.some((t=>t instanceof s.FieldTypeArray&&e(t.validTypesArray,i.validTypesArray))))return!1}else{if(!(0,l.isNDimensionalFieldTypeArray)(i))return!1;{const n=t.find(l.isNDimensionalFieldTypeArray);if(!n||!e(n.validTypesArray,i.validTypesArray))return!1}}return!0},t.serializeFieldTypeDefinition=function(e){return(0,n.isArray)(e)?e.map(r.serializeBaseFieldTypeDefinition):(0,r.serializeBaseFieldTypeDefinition)(e)},t.deserializeFieldTypeDefinition=function(e){return(0,n.isArray)(e)?e.map(r.deserializeBaseFieldTypeDefinition):(0,r.deserializeBaseFieldTypeDefinition)(e)},t.isSerializedFieldTypeDefinition=function(e){return(0,n.isArray)(e)?e.every(r.isSerializedBaseFieldTypeDefinition):(0,r.isSerializedBaseFieldTypeDefinition)(e)}},3581:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deserializeLiteralFieldType=t.isSerializedLiteralFieldType=t.isLiteralFieldType=t.LiteralFieldType=void 0;const n=i(6930),r=i(6798);class o{constructor(e){this.scalarFieldType=r.ScalarFieldTypeEnum.ANY,(0,n.isString)(e)?(this.literal=e.substring(o.literalStringPrefix.length),this.scalarFieldType=r.ScalarFieldTypeEnum.STRING):(0,n.isBoolean)(e)?(this.literal=e,this.scalarFieldType=r.ScalarFieldTypeEnum.BOOLEAN):(this.literal=e,this.scalarFieldType=r.ScalarFieldTypeEnum.NUMBER)}getLiteral(){return this.literal}getScalarFieldType(){return this.scalarFieldType}toJSON(){return this.scalarFieldType===r.ScalarFieldTypeEnum.STRING?o.literalStringPrefix+this.literal:this.literal.toString()}}t.LiteralFieldType=o,o.literalStringPrefix="%",t.isLiteralFieldType=function(e){return e instanceof o},t.isSerializedLiteralFieldType=function(e){return(0,n.isString)(e)},t.deserializeLiteralFieldType=function(e){if(e.startsWith(o.literalStringPrefix))return new o(e);const t=Number(e);return isNaN(t)||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY?new o("true"===e):new o(t)}},6730:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deserializeNDimensionalFieldTypeArray=t.isSerializedNDimensionalFieldTypeArray=t.isNDimensionalFieldTypeArray=t.isValidTypeForNDimensionalFieldTypeArray=t.NDimensionalFieldTypeArray=void 0;const n=i(6930),r=i(3581),o=i(6798);class s{constructor(e){this.validTypesArray=e}getInnerTypes(){return[...this.validTypesArray,this]}getInnerNonArrayTypes(){return this.validTypesArray.filter((e=>(0,o.isScalarFieldTypeEnum)(e)||(0,r.isLiteralFieldType)(e)))}toJSON(){return{ND:!0,validTypes:this.validTypesArray.map((e=>(0,o.isScalarFieldTypeEnum)(e)?e:e.toJSON()))}}}t.NDimensionalFieldTypeArray=s,t.isValidTypeForNDimensionalFieldTypeArray=function(e){return(0,o.isScalarFieldTypeEnum)(e)||(0,r.isLiteralFieldType)(e)},t.isNDimensionalFieldTypeArray=function(e){return e instanceof s},t.isSerializedNDimensionalFieldTypeArray=function(e){return(0,n.isObjectUnsafe)(e)&&(0,n.isBoolean)(e.ND)&&!0===e.ND&&(0,n.isTypedArray)(n.isAny)(e.validTypes)&&e.validTypes.every((e=>(0,n.isDefAndNotNull)(o.ScalarFieldTypeEnum[e])||(0,r.isSerializedLiteralFieldType)(e)))},t.deserializeNDimensionalFieldTypeArray=function(e){return new s(e.validTypes.map((e=>(0,r.isSerializedLiteralFieldType)(e)?(0,r.deserializeLiteralFieldType)(e):e)))}},6798:(e,t)=>{var i;Object.defineProperty(t,"__esModule",{value:!0}),t.isScalarFieldTypeEnum=t.AnyScalarFieldType=t.ScalarFieldTypeEnum=void 0,function(e){e[e.ANY=0]="ANY",e[e.NUMBER=1]="NUMBER",e[e.BOOLEAN=2]="BOOLEAN",e[e.STRING=3]="STRING",e[e.COLOR=4]="COLOR",e[e.DATE=5]="DATE",e[e.NULL=6]="NULL",e[e.DICTIONARY=7]="DICTIONARY",e[e.CURRENCY=8]="CURRENCY",e[e.DATEONLY=9]="DATEONLY",e[e.TIMEONLY=10]="TIMEONLY"}(i||(t.ScalarFieldTypeEnum=i={})),t.AnyScalarFieldType=[i.ANY,i.NUMBER,i.STRING,i.BOOLEAN,i.COLOR,i.DATE,i.DATEONLY,i.NULL,i.DICTIONARY,i.CURRENCY,i.TIMEONLY];const n=new Set(t.AnyScalarFieldType);t.isScalarFieldTypeEnum=e=>n.has(e)},9753:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isSemanticFields=t.SemanticFields=void 0;const n=i(7660);var r;!function(e){e.Title="title",e.Description="description",e.User="user",e.Reporter="user.reporter",e.Time="time",e.EndTime="time.endtime",e.Estimate="estimate",e.Status="status",e.IssueType="issuetype",e.Priority="priority",e.Project="project",e.SourceItemUrl="url",e.ImageUrl="url.image"}(r||(t.SemanticFields=r={})),t.isSemanticFields=(0,n.stringEnumValidator)(r)},5070:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.semanticKindToSemanticFields=t.isSemanticKind=t.SemanticKind=void 0;const n=i(7660),r=i(9753);var o;!function(e){e.Id="id",e.Title="title",e.Name="name",e.Image="image",e.Description="description",e.Assignee="assignee",e.Estimate="estimate",e.Status="status",e.IssueType="issuetype",e.Priority="priority",e.Project="project",e.Reporter="reporter",e.StartTime="starttime",e.EndTime="endtime",e.GroupByHint="groupbyhint",e.PrimaryKeyReference="primarykeyreference",e.URL="url"}(o||(t.SemanticKind=o={})),t.isSemanticKind=(0,n.enumValidator)(o),t.semanticKindToSemanticFields=function(e){if((0,r.isSemanticFields)(e))return e;switch(e){case o.Id:return;case o.Title:case o.Name:return r.SemanticFields.Title;case o.Image:return r.SemanticFields.ImageUrl;case o.Description:return r.SemanticFields.Description;case o.Assignee:return r.SemanticFields.User;case o.Estimate:return r.SemanticFields.Estimate;case o.Status:return r.SemanticFields.Status;case o.IssueType:return r.SemanticFields.IssueType;case o.Priority:return r.SemanticFields.Priority;case o.Project:return r.SemanticFields.Project;case o.Reporter:return r.SemanticFields.Reporter;case o.StartTime:return r.SemanticFields.Time;case o.EndTime:return r.SemanticFields.EndTime;case o.GroupByHint:case o.PrimaryKeyReference:return;case o.URL:return r.SemanticFields.SourceItemUrl;default:return}}},6326:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isSerializedFlattenedReference=t.isUnTypedSerializedFlattenedReference=t.isTypedSerializedFlattenedReference=t.FlattenedReferenceKeyName=t.FlattenedReferenceKeyId=void 0;const n=i(6930);function r(e){return(0,n.isObjectUnsafe)(e)&&(0,n.isObject)(e.sc)&&(0,n.isObject)(e.d)}function o(e){return(0,n.isObjectUnsafe)(e)&&!0===e[t.FlattenedReferenceKeyId]}t.FlattenedReferenceKeyId="192d0e9f-2f5a-4032-9f03-59bbf1ea5891",t.FlattenedReferenceKeyName="192d0e9f-2f5a-4032-9f03-59bbf1ea5891_n",t.isTypedSerializedFlattenedReference=r,t.isUnTypedSerializedFlattenedReference=o,t.isSerializedFlattenedReference=function(e){return o(e)||r(e)}},5271:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isSerializedDataItems=void 0;const n=i(7660),r=i(1346);t.isSerializedDataItems=(0,n.objectOfValidator)(r.isSerializedFields)},9098:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isSerializedFieldDefinition=t.isSerializedFieldConstraint=t.isFieldConstraintType=t.FieldConstraintType=void 0;const n=i(6930),r=i(7660),o=i(2939),s=i(9753),a=i(5070);var l;!function(e){e.REQUIRED="required",e.LOCKED="locked",e.MIN_VALUE="minValue",e.MAX_VALUE="maxValue",e.SINGLE_LINE_ONLY="singleLineOnly",e.NO_WHITESPACE="noWhitespace",e.UNIQUE_EDIT="uniqueEditType",e.MAX_LENGTH="maxLength"}(l||(t.FieldConstraintType=l={})),t.isFieldConstraintType=(0,r.enumValidator)(l),t.isSerializedFieldConstraint=(0,r.objectValidator)({Type:(0,r.enumValidator)(l),Details:(0,r.option)(n.isAny)}),t.isSerializedFieldDefinition=(0,r.strictObjectValidator)({Name:n.isString,Type:o.isSerializedFieldTypeDefinition,Constraints:(0,r.option)((0,r.arrayValidator)(t.isSerializedFieldConstraint)),SyncSchema:(0,r.option)(n.isString),Mapping:(0,r.option)((0,r.either)((0,r.arrayValidator)(s.isSemanticFields),(0,r.arrayValidator)(a.isSemanticKind)))})},1346:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isSerializedFields=t.isSerializedJsonFieldType=t.isSerializedFieldType=t.isSerializedTimeObject=t.isSerializedLucidDateObject=t.isSerializedMillisecondsDateObject=t.isSerializedLucidCurrency=t.isSerializedLucidDictionary=t.isJsonSerializedLucidDictionary=t.isNestedSerializedLucidDictionary=t.isSerializedColorObjectFieldType=void 0;const n=i(6930),r=i(7660);function o(e){return(0,n.isObjectUnsafe)(e)&&(0,n.isObject)(e.color)}t.isSerializedColorObjectFieldType=o,t.isNestedSerializedLucidDictionary=(0,r.strictObjectValidator)({dict:(0,r.mapValidator)(a)}),t.isJsonSerializedLucidDictionary=(0,r.strictObjectValidator)({js:(0,r.mapValidator)(l)}),t.isSerializedLucidDictionary=(0,r.either)(t.isNestedSerializedLucidDictionary,t.isJsonSerializedLucidDictionary),t.isSerializedLucidCurrency=(0,r.objectValidator)({a:n.isNumber,t:n.isString}),t.isSerializedMillisecondsDateObject=(0,r.objectValidator)({ms:n.isNumber,isDateOnly:(0,r.option)(n.isBoolean)});const s=(0,r.objectValidator)({isoDate:n.isString,displayTimezone:(0,r.option)(n.isString)});function a(e){return null==e||(0,n.isNumber)(e)||(0,n.isString)(e)||(0,n.isBoolean)(e)||(0,t.isSerializedLucidDictionary)(e)||(0,t.isSerializedLucidCurrency)(e)||(0,n.isArray)(e)&&e.every(a)||(0,t.isSerializedLucidDateObject)(e)||(0,t.isSerializedTimeObject)(e)||o(e)}function l(e){return null==e||(0,n.isNumber)(e)||(0,n.isString)(e)||(0,n.isBoolean)(e)||(0,n.isArray)(e)&&e.every(l)||(0,n.isObject)(e)&&Object.values(e).every(l)}t.isSerializedLucidDateObject=(0,r.either)(t.isSerializedMillisecondsDateObject,s),t.isSerializedTimeObject=(0,r.objectValidator)({hours:n.isNumber,minutes:(0,r.option)(n.isNumber),seconds:(0,r.option)(n.isNumber)}),t.isSerializedFieldType=a,t.isSerializedJsonFieldType=l,t.isSerializedFields=(0,r.objectOfValidator)(a)},4196:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isSerializedSchema=void 0;const n=i(6930),r=i(7660),o=i(9098);t.isSerializedSchema=function(e){if(null==e)return!1;const t=e.Fields,i=e.PrimaryKey,s=e.FieldLabelOverrides,a=!(0,n.isDefAndNotNull)(s)||(0,n.isRecord)(n.isString)(s)&&!(0,n.isArray)(s);return(0,n.isTypedArray)(o.isSerializedFieldDefinition)(t)&&(0,r.arrayValidator)(o.isSerializedFieldDefinition)(t)&&(0,n.isArray)(i)&&i.every(n.isString)&&a}},97:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},2555:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.defer=void 0,t.defer=function(){let e,t;!function(){if("function"!=typeof Promise)throw new Error("No promise library available")}();const i=new Promise(((i,n)=>{e=i,t=n}));if(!e||!t)throw new Error("Promise constructor does not provide proper arguments to callback");return{resolve:e,reject:t,promise:i,then:i.then.bind(i),catch:i.catch.bind(i),finally:i.finally.bind(i),[Symbol.toStringTag]:i[Symbol.toStringTag]}}},1690:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},8326:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.HumanReadableError=void 0;class i extends Error{constructor(){super(...arguments),this.name="HumanReadableError"}}t.HumanReadableError=i},7909:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseIFrameAttributesFromHTML=t.generateIFrameHTML=t.DEFAULT_IFRAME_HEIGHT=t.DEFAULT_IFRAME_WIDTH=void 0;const n=i(6930);t.DEFAULT_IFRAME_WIDTH=16,t.DEFAULT_IFRAME_HEIGHT=9;const r=/src="((https:\/\/|\/\/).*?)"/i,o=/height="(\d*?)"/i,s=/width="(\d*?)"/i,a=/title="(.*?)"/i;t.generateIFrameHTML=function(e){let t=`<iframe src="${e.src}"`;return e.width&&(t+=` width="${e.width.toString()}"`),e.height&&(t+=` height="${e.height.toString()}"`),e.title&&(t+=` title="${e.title.replace(/"/g,"&quot;")}"`),t+="></iframe>",t},t.parseIFrameAttributesFromHTML=function(e){var i,l,c,d,u,h;if(!e.startsWith("<iframe"))return{srcdoc:e,height:t.DEFAULT_IFRAME_HEIGHT,width:t.DEFAULT_IFRAME_WIDTH};const p=null!==(l=null===(i=e.match(r))||void 0===i?void 0:i[1])&&void 0!==l?l:"",m=null===(c=e.match(o))||void 0===c?void 0:c[1],y=null===(d=e.match(s))||void 0===d?void 0:d[1],f=null!==(h=null===(u=e.match(a))||void 0===u?void 0:u[1])&&void 0!==h?h:"";return{src:p,height:(0,n.isUndefined)(m)?t.DEFAULT_IFRAME_HEIGHT:Number.parseInt(m),width:(0,n.isUndefined)(y)?t.DEFAULT_IFRAME_WIDTH:Number.parseInt(y),title:f}}},6390:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isJsonObject=t.isJsonSerializable=void 0;const n=i(6930);function r(e){return null==e||(0,n.isString)(e)||(0,n.isNumber)(e)||(0,n.isBoolean)(e)||(0,n.isArray)(e)&&e.every(r)||o(e)}function o(e){if(!(0,n.isObjectUnsafe)(e))return!1;for(const t in e)if(!r(e[t]))return!1;return!0}t.isJsonSerializable=r,t.isJsonObject=o},1251:(e,t)=>{var i;Object.defineProperty(t,"__esModule",{value:!0}),t.LucidProduct=void 0,function(e){e.Chart="chart",e.Spark="spark",e.TeamSpaces="teamspaces"}(i||(t.LucidProduct=i={}))},1292:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.fromEntries=t.flatten=t.objectEvery=void 0,t.objectEvery=function(e,t,i){for(const n in e)if(!t.call(i,e[n],n,e))return!1;return!0},t.flatten=function(e){const t=[];for(const i of e)t.push(...i);return t},t.fromEntries=function(e){const t={};for(const[i,n]of e)t[i]=n;return t}},472:(e,t)=>{var i;Object.defineProperty(t,"__esModule",{value:!0}),t.isLinearOffsetType=t.OffsetType=void 0,function(e){e[e.NW=0]="NW",e[e.NE=1]="NE",e[e.SE=2]="SE",e[e.SW=3]="SW",e[e.MOVE=4]="MOVE",e[e.ROTATE=5]="ROTATE",e[e.SCALE=6]="SCALE",e[e.CUSTOM=7]="CUSTOM",e[e.N=8]="N",e[e.E=9]="E",e[e.S=10]="S",e[e.W=11]="W"}(i||(t.OffsetType=i={})),t.isLinearOffsetType=function(e){return e===i.NW||e===i.NE||e===i.SE||e===i.SW||e===i.MOVE||e===i.N||e===i.E||e===i.S||e===i.W}},9720:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},4210:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isLayerPos=t.isVerticalPos=t.isHorizontalPos=t.isValidSerializedBadgeEnumPosition=t.serializeBadgeEnumPositionAsKey=t.serializeBadgeEnumPosition=t.deserializeBadgeEnumPosition=t.badgePositionsEqual=t.defaultBadgePositionSerialized=t.defaultBadgePosition=t.BadgePositionsClockwise=t.BadgeResponsiveness=t.BadgeLayerPos=t.VerticalBadgePos=t.HorizontalBadgePos=void 0;const n=i(6930);var r,o,s,a;!function(e){e[e.LEFT=0]="LEFT",e[e.CENTER=1]="CENTER",e[e.RIGHT=2]="RIGHT"}(r||(t.HorizontalBadgePos=r={})),function(e){e[e.TOP=0]="TOP",e[e.CENTER=1]="CENTER",e[e.BOTTOM=2]="BOTTOM"}(o||(t.VerticalBadgePos=o={})),function(e){e[e.INSIDE=0]="INSIDE",e[e.EDGE=1]="EDGE",e[e.OUTSIDE=2]="OUTSIDE"}(s||(t.BadgeLayerPos=s={})),function(e){e[e.STATIC=0]="STATIC",e[e.STACK=1]="STACK"}(a||(t.BadgeResponsiveness=a={})),t.BadgePositionsClockwise=[{horizontalPos:0,verticalPos:0},{horizontalPos:1,verticalPos:0},{horizontalPos:2,verticalPos:0},{horizontalPos:2,verticalPos:1},{horizontalPos:2,verticalPos:2},{horizontalPos:1,verticalPos:2},{horizontalPos:0,verticalPos:2},{horizontalPos:0,verticalPos:1}],t.defaultBadgePosition={horizontalPos:r.RIGHT,verticalPos:o.TOP,layer:s.EDGE,responsive:a.STACK},t.defaultBadgePositionSerialized={horiz:r.RIGHT,vert:o.TOP,layer:s.EDGE,responsive:a.STACK},t.badgePositionsEqual=function(e,t){return e.horizontalPos===t.horizontalPos&&e.verticalPos===t.verticalPos&&e.layer===t.layer&&e.responsive===t.responsive},t.deserializeBadgeEnumPosition=function(e){if(null!=e)return{horizontalPos:null!=e.horiz?e.horiz:t.defaultBadgePosition.horizontalPos,verticalPos:null!=e.vert?e.vert:t.defaultBadgePosition.verticalPos,layer:null!=e.layer?e.layer:t.defaultBadgePosition.layer,responsive:null!=e.responsive?e.responsive:t.defaultBadgePosition.responsive}},t.serializeBadgeEnumPosition=function(e){return null==e?{horiz:t.defaultBadgePosition.horizontalPos,vert:t.defaultBadgePosition.verticalPos,layer:t.defaultBadgePosition.layer,responsive:t.defaultBadgePosition.responsive}:{horiz:e.horizontalPos,vert:e.verticalPos,layer:e.layer,responsive:e.responsive}},t.serializeBadgeEnumPositionAsKey=function(e){return JSON.stringify(e)},t.isValidSerializedBadgeEnumPosition=function(e){const t=null==e.horiz||Object.values(r).includes(e.horiz),i=null==e.vert||Object.values(o).includes(e.vert),n=null==e.layer||Object.values(s).includes(e.layer),l=null==e.responsive||Object.values(a).includes(e.responsive);return t&&i&&n&&l},t.isHorizontalPos=function(e){return!!(0,n.isNumber)(e)&&!!r[e]},t.isVerticalPos=function(e){return!!(0,n.isNumber)(e)&&!!o[e]},t.isLayerPos=function(e){return!!(0,n.isNumber)(e)&&!!s[e]}},1912:(e,t)=>{var i;function n(e,t){return null==e||null==t?e==t:e.w==t.w&&e.h==t.h&&e.url==t.url}Object.defineProperty(t,"__esModule",{value:!0}),t.areDataGraphicImagesEqual=t.areDataGraphicIconIndexesEqual=t.DataGraphicIconSets=void 0,function(e){e[e.CUSTOM_ICONS=-1]="CUSTOM_ICONS",e[e.STATUS_ICONS=0]="STATUS_ICONS",e[e.STATUS_CIRCLES=1]="STATUS_CIRCLES",e[e.STOPLIGHTS=2]="STOPLIGHTS",e[e.TOGGLES=3]="TOGGLES",e[e.COMPLETION_PIES=4]="COMPLETION_PIES",e[e.TRENDING_ARROWS=5]="TRENDING_ARROWS",e[e.STATUS_CHECK_BOXES=6]="STATUS_CHECK_BOXES",e[e.TRENDING_ARROWS_FLIPPED=7]="TRENDING_ARROWS_FLIPPED"}(i||(t.DataGraphicIconSets=i={})),t.areDataGraphicIconIndexesEqual=function(e,t){return e.set==t.set&&e.index==t.index&&n(e.iconImage,t.iconImage)},t.areDataGraphicImagesEqual=n},2969:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isSerializedSimpleStaticDataGraphicSettings=t.deserializeSimpleStaticDataGraphicSettings=t.serializeSimpleStaticDataGraphicSettings=void 0;const n=i(6930),r=i(4210);t.serializeSimpleStaticDataGraphicSettings=function(e){return{icon:e.icon,pos:(0,r.serializeBadgeEnumPosition)(e.position),color:e.color}},t.deserializeSimpleStaticDataGraphicSettings=function(e){return{icon:e.icon,position:(0,r.deserializeBadgeEnumPosition)(e.pos),color:e.color}},t.isSerializedSimpleStaticDataGraphicSettings=function(e){return(0,n.isObjectUnsafe)(e)&&(0,n.isString)(e.color)&&(0,n.isObject)(e.icon)&&(0,r.isValidSerializedBadgeEnumPosition)(e.pos)}},8333:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.serializeSimpleFill=t.SimpleImageFillPosition=void 0;const n=i(6930);var r;!function(e){e.Fit="fit",e.Fill="fill",e.Stretch="stretch",e.Original="original",e.Tile="tile"}(r||(t.SimpleImageFillPosition=r={})),t.serializeSimpleFill=function(e){return(0,n.isString)(e)?e:{pos:e.position,url:e.url,polys:null}}},7713:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deserializeShadow=t.serializeShadow=void 0,t.serializeShadow=function(e){return{x:e.distance*Math.cos(e.angle),y:e.distance*Math.sin(e.angle),b:e.blur,c:e.color,ang:e.angle}},t.deserializeShadow=function(e){var t;return{distance:Math.sqrt(e.x*e.x+e.y*e.y),angle:null!==(t=e.ang)&&void 0!==t?t:Math.atan2(e.y,e.x),blur:e.b,color:e.c}}},2188:(e,t)=>{var i;Object.defineProperty(t,"__esModule",{value:!0}),t.convertStrokeStyleToBorder=t.isStrokeStyle=t.StrokeStyle=void 0,function(e){e.Solid="solid",e.Dashed="dashed",e.LongDash="longdash",e.DashDot="dashdot",e.DashDotDot="dashdotdot",e.DashLongDash="dashlongdash",e.Dashed32="dashed32",e.Dashed44="dashed44",e.Dashed24="dashed24",e.Dotted="dotted",e.DotDotDot="dotdotdot",e.StripeThinThin="stripethinthin",e.StripeThickThick="stripethickthick",e.StripeThickThin="stripethickthin",e.StripeThinThick="stripethinthick",e.StripeThickThinThick="stripethickthinthick",e.StripeThinThickThin="stripethinthickthin",e.StripeTriple="stripetriple"}(i||(t.StrokeStyle=i={}));const n=new Set(Object.values(i));t.isStrokeStyle=function(e){return n.has(e)},t.convertStrokeStyleToBorder=function(e){return e.startsWith("dash")||e==i.LongDash?"dashed":e.startsWith("dot")?"dotted":"solid"}},7346:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isEqual=t.groupByResultType=t.isFailure=t.isSuccess=void 0;const n=i(6930);function r(e){return(0,n.isDef)(e.value)}function o(e){return(0,n.isDef)(e.error)}t.isSuccess=r,t.isFailure=o,t.groupByResultType=function(e){const t=[],i=[];return e.forEach((e=>{r(e)?t.push(e):i.push(e)})),[t,i]},t.isEqual=function(e,t,i,n){return!!e&&!!t&&(r(e)&&r(t)&&i(e.value,t.value)||o(e)&&o(t)&&n(e.error,t.error))||e==t}},9341:(e,t)=>{var i,n,r,o,s,a;Object.defineProperty(t,"__esModule",{value:!0}),t.ContainmentConditions=t.ConnectedShapesCondition=t.ShapeTypeConditions=t.ShapeDataConditions=t.TextConditions=t.ConditionCombination=void 0,function(e){e.AND="AND",e.OR="OR"}(i||(t.ConditionCombination=i={})),function(e){e[e.TextEmpty=0]="TextEmpty",e[e.TextNotEmpty=1]="TextNotEmpty",e[e.TextContains=2]="TextContains",e[e.TextDoesNotContain=3]="TextDoesNotContain",e[e.GreaterThan=8]="GreaterThan",e[e.GreaterThanOrEqual=9]="GreaterThanOrEqual",e[e.LessThan=10]="LessThan",e[e.LessThanOrEqual=11]="LessThanOrEqual",e[e.Equal=12]="Equal",e[e.NotEqual=13]="NotEqual",e[e.Between=14]="Between",e[e.NotBetween=15]="NotBetween"}(n||(t.TextConditions=n={})),function(e){e[e.TextEmpty=0]="TextEmpty",e[e.TextNotEmpty=1]="TextNotEmpty",e[e.TextContains=2]="TextContains",e[e.TextDoesNotContain=3]="TextDoesNotContain",e[e.TextEquals=4]="TextEquals",e[e.TextNotEqual=5]="TextNotEqual",e[e.TextStartsWith=6]="TextStartsWith",e[e.TextEndsWith=7]="TextEndsWith",e[e.GreaterThan=8]="GreaterThan",e[e.GreaterThanOrEqual=9]="GreaterThanOrEqual",e[e.LessThan=10]="LessThan",e[e.LessThanOrEqual=11]="LessThanOrEqual",e[e.Equal=12]="Equal",e[e.NotEqual=13]="NotEqual",e[e.Between=14]="Between",e[e.NotBetween=15]="NotBetween"}(r||(t.ShapeDataConditions=r={})),function(e){e[e.TextContains=2]="TextContains",e[e.TextDoesNotContain=3]="TextDoesNotContain"}(o||(t.ShapeTypeConditions=o={})),function(e){e[e.GreaterThan=8]="GreaterThan",e[e.GreaterThanOrEqual=9]="GreaterThanOrEqual",e[e.LessThan=10]="LessThan",e[e.LessThanOrEqual=11]="LessThanOrEqual",e[e.Equal=12]="Equal",e[e.NotEqual=13]="NotEqual",e[e.Between=14]="Between",e[e.NotBetween=15]="NotBetween"}(s||(t.ConnectedShapesCondition=s={})),function(e){e[e.TextContains=2]="TextContains",e[e.TextDoesNotContain=3]="TextDoesNotContain"}(a||(t.ContainmentConditions=a={}))},4718:(e,t)=>{var i;Object.defineProperty(t,"__esModule",{value:!0}),t.ConditionType=void 0,function(e){e[e.Text=0]="Text",e[e.ShapeData=1]="ShapeData",e[e.Formula=2]="Formula",e[e.ShapeType=3]="ShapeType",e[e.ConnectedShapes=4]="ConnectedShapes",e[e.Containment=5]="Containment"}(i||(t.ConditionType=i={}))},8448:(e,t)=>{var i;Object.defineProperty(t,"__esModule",{value:!0}),t.RuleFormattingType=void 0,function(e){e[e.FORMATTING=0]="FORMATTING",e[e.DATA_GRAPHICS=1]="DATA_GRAPHICS",e[e.STENCIL=2]="STENCIL"}(i||(t.RuleFormattingType=i={}))},3191:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isSerializedDataError=void 0;const n=i(6930);t.isSerializedDataError=function(e){return(0,n.isObjectUnsafe)(e)&&(0,n.isString)(e.error)&&(0,n.isNumber)(e.type)}},816:(e,t)=>{var i;Object.defineProperty(t,"__esModule",{value:!0}),t.ShapeDataInheritance=void 0,function(e){e[e.NONE=0]="NONE",e[e.NAME=1]="NAME",e[e.VALUE=2]="VALUE"}(i||(t.ShapeDataInheritance=i={}))},8137:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LucidSpreadsheetIntegration=t.isImportedResults=t.lucidSpreadsheetIntegrationFailureTypeValidator=t.LucidSpreadsheetIntegrationFailureType=void 0;const n=i(6930),r=i(4827),o=i(4196),s=i(6390),a=i(7660);var l;!function(e){e.AuthorizationFailure="AuthorizationFailure",e.GenericFailure="GenericFailure",e.UserCancelled="UserCanceled"}(l||(t.LucidSpreadsheetIntegrationFailureType=l={})),t.lucidSpreadsheetIntegrationFailureTypeValidator=(0,a.stringEnumValidator)(l),t.isImportedResults=(0,a.strictObjectValidator)({upstreamConfig:r.isSerializedUpstreamConfig,collections:(0,a.arrayValidator)((0,a.strictObjectValidator)({collectionId:n.isString,headerRow:n.isNumber,schema:o.isSerializedSchema,upstreamConfig:s.isJsonSerializable}))}),t.LucidSpreadsheetIntegration=class{}},6982:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LucidSpreadsheetIntegrationRegistry=void 0;const n=i(8137);class r{static nextHookName(){return"__lucidspreadsheet__hook"+this.nextHookId++}static addSpreadsheetIntegration(e,t){const i=r.nextHookName();e.registerAction(i,(async()=>{try{return await t.getSpreadsheetDetailsToImport()}catch(e){}return n.LucidSpreadsheetIntegrationFailureType.GenericFailure}));const o=r.nextHookName();e.registerAction(o,(async e=>{try{const i=await t.getMultipleSheetsForSpreadsheetDetails(e.spreadsheetDetails);return(0,n.lucidSpreadsheetIntegrationFailureTypeValidator)(i)?i:Array.from(i)}catch(e){}return n.LucidSpreadsheetIntegrationFailureType.GenericFailure}));const s={ld:t.labelDescription,li:t.labelIconUrl,dc:t.dataConnectorName,gs:i,gm:o};e.sendCommand("asi",s)}}t.LucidSpreadsheetIntegrationRegistry=r,r.nextHookId=0},5996:(e,t)=>{var i;Object.defineProperty(t,"__esModule",{value:!0}),t.UnfurlCallbackType=void 0,function(e){e.Unfurl="u",e.AfterUnfurl="a",e.ExpandCallback="e"}(i||(t.UnfurlCallbackType=i={}))},1430:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.serializeUnfurlDetails=t.deserializeUnfurlDetails=t.isValidUnfurlDetails=void 0;const n=i(6930),r=i(7660),o=i(3578),s=i(3436);t.isValidUnfurlDetails=(0,r.objectValidator)({ProviderName:n.isString,ProviderFaviconUrl:n.isString,UnfurlTitle:(0,r.option)(n.isString),Iframe:(0,r.option)(o.isValidUnfurlIframe),Thumbnails:(0,r.option)((0,r.arrayValidator)(s.isValidUnfurlThumbnail)),PreviewImageUrl:(0,r.option)(n.isString)}),t.deserializeUnfurlDetails=function(e){var t;return{providerName:e.ProviderName,providerFaviconUrl:e.ProviderFaviconUrl,unfurlTitle:e.UnfurlTitle,iframe:e.Iframe&&(0,o.deserializeUnfurlIframe)(e.Iframe),thumbnails:null===(t=e.Thumbnails)||void 0===t?void 0:t.map((e=>(0,s.deserializeUnfurlThumbnail)(e))),previewImageUrl:e.PreviewImageUrl}},t.serializeUnfurlDetails=function(e){var t;return{ProviderName:e.providerName,ProviderFaviconUrl:e.providerFaviconUrl,UnfurlTitle:e.unfurlTitle,Iframe:e.iframe&&(0,o.serializeUnfurlIframe)(e.iframe),Thumbnails:null===(t=e.thumbnails)||void 0===t?void 0:t.map((e=>(0,s.serializeUnfurlThumbnail)(e))),PreviewImageUrl:e.previewImageUrl}}},3578:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.generateIframeAttributes=t.getIFrameWidth=t.getIFrameHeight=t.serializeUnfurlIframe=t.deserializeUnfurlIframe=t.isValidUnfurlIframe=t.UnfurlIframeAspectRatio=void 0;const n=i(6930),r=i(7909),o=i(7660);var s;function a(e){switch(e){case s.Square:return 1;case s.SixteenToNine:return 9;case s.NineToSixteen:return 16;case s.FourToThree:return 3;case s.ThreeToFour:return 4;default:return 9}}function l(e){switch(e){case s.Square:return 1;case s.SixteenToNine:return 16;case s.NineToSixteen:return 9;case s.FourToThree:return 4;case s.ThreeToFour:return 3;default:return 16}}!function(e){e.Square="1:1",e.SixteenToNine="16:9",e.NineToSixteen="9:16",e.FourToThree="4:3",e.ThreeToFour="3:4"}(s||(t.UnfurlIframeAspectRatio=s={})),t.isValidUnfurlIframe=(0,o.objectValidator)({IframeUrl:n.isString,AspectRatio:(0,o.option)((0,o.stringEnumValidator)(s)),IframeTitle:(0,o.option)(n.isString)}),t.deserializeUnfurlIframe=function(e){return{iframeUrl:e.IframeUrl,aspectRatio:e.AspectRatio,iframeTitle:e.IframeTitle}},t.serializeUnfurlIframe=function(e){return{IframeUrl:e.iframeUrl,AspectRatio:e.aspectRatio,IframeTitle:e.iframeTitle}},t.getIFrameHeight=a,t.getIFrameWidth=l,t.generateIframeAttributes=function(e){return{src:e.iframeUrl,height:e.aspectRatio?a(e.aspectRatio):r.DEFAULT_IFRAME_HEIGHT,width:e.aspectRatio?l(e.aspectRatio):r.DEFAULT_IFRAME_WIDTH,title:e.iframeTitle}}},3893:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.unfurlRefreshErrorTypeValidator=t.UnfurlRefreshErrorType=void 0;const n=i(7660);var r;!function(e){e.AuthorizationFailure="Authorization failure",e.GenericFailure="Generic failure"}(r||(t.UnfurlRefreshErrorType=r={})),t.unfurlRefreshErrorTypeValidator=(0,n.stringEnumValidator)(r)},3436:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.serializeUnfurlThumbnail=t.deserializeUnfurlThumbnail=t.isValidUnfurlThumbnail=void 0;const n=i(6930),r=i(7660);t.isValidUnfurlThumbnail=(0,r.objectValidator)({url:n.isString,width:(0,r.nullableOption)(n.isNumber),height:(0,r.nullableOption)(n.isNumber)}),t.deserializeUnfurlThumbnail=function(e){var t,i;return{url:e.url,width:null!==(t=e.width)&&void 0!==t?t:void 0,height:null!==(i=e.height)&&void 0!==i?i:void 0}},t.serializeUnfurlThumbnail=function(e){return{url:e.url,width:e.width,height:e.height}}},7660:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.asAssertion=t.validatorWithMessage=t.minLengthValidator=t.maxLengthValidator=t.isDate=t.isPositiveNumber=t.isSize=t.isPanelSize=t.isBoundingBox=t.isPointLike=t.isOpacity=t.isFalse=t.isTrue=t.isFlag=t.isRestrictions=t.isStringOrNegativeOne=t.isBooleanOrEmptyString=t.isNumberOrEmptyString=t.isSet=t.propertyValidator=t.exclude=t.both=t.either=t.isNullOption=t.nullableOption=t.option=t.nullable=t.objectOfValidator=t.typedRecordValidator=t.recordValidator=t.strictObjectValidator=t.partialObjectValidator=t.objectValidator=t.mapValidator=t.someValidator=t.someValue=t.tupleValidator=t.arrayValidator=t.rangeValidator=t.enumValidator=t.stringEnumValidator=void 0;const n=i(6930),r=i(1292);function o(e,t){return i=>(0,n.isNumber)(i)&&i>=e&&i<=t}function s(e){return t=>!((0,n.isArray)(t)||!(0,n.isObjectUnsafe)(t))&&(0,r.objectEvery)(e,((e,i)=>e(t[i])))}function a(e){const t=s(e);return i=>t(i)&&(0,r.objectEvery)(i,((t,i)=>void 0===t||e.hasOwnProperty(i)))}function l(e){return t=>null==t||e(t)}function c(e,t){return i=>e(i)||t(i)}t.stringEnumValidator=function(e){const t=new Set;for(const i in e){const r=e[i];(0,n.isString)(r)&&t.add(r)}const i=t;return e=>i.has(e)},t.enumValidator=function(e){return t=>{for(const i in e)if(e[i]===t)return!0;return!1}},t.rangeValidator=o,t.arrayValidator=function(e){return t=>(0,n.isArray)(t)&&t.every(e)},t.tupleValidator=function(...e){return t=>"object"==typeof t&&e.length===t.length&&e.every(((e,i)=>e(t[i])))},t.someValue=function(...e){return t=>{for(const i of e)if(t===i)return!0;return!1}},t.someValidator=function(...e){return t=>{for(const i of e)if(i(t))return!0;return!1}},t.mapValidator=function(e){return t=>(0,n.isObject)(t)&&!(0,n.isArray)(t)&&(0,r.objectEvery)(t,e)},t.objectValidator=s,t.partialObjectValidator=function(e){return t=>!((0,n.isArray)(t)||!(0,n.isObjectUnsafe)(t))&&(0,r.objectEvery)(e,((e,i)=>void 0===t[i]||e(t[i])))},t.strictObjectValidator=a,t.recordValidator=function(e,t){return i=>(0,n.isObject)(i)&&!(0,n.isArray)(i)&&e.every((e=>e in i))&&(0,r.objectEvery)(i,((e,i)=>t(e)))},t.typedRecordValidator=function(e,t){return i=>!((0,n.isArray)(i)||!(0,n.isObject)(i))&&Object.keys(i).every((t=>e(t)))&&Object.values(i).every((e=>t(e)))},t.objectOfValidator=function(e){return t=>!((0,n.isArray)(t)||!(0,n.isObject)(t))&&Object.values(t).every((t=>e(t)))},t.nullable=function(e){return t=>null===t||e(t)},t.option=function(e){return t=>void 0===t||e(t)},t.nullableOption=l,t.isNullOption=e=>null==e,t.either=c,t.both=function(e,t){return i=>e(i)&&t(i)},t.exclude=function(e,t){return i=>e(i)&&!t(i)},t.propertyValidator=function(e,t){return a({Equation:n.isString,StaticValue:i=>{const n=t.reduce(((e,t)=>t(e)),i);return e(n)}})},t.isSet=function(e){return(0,n.isObject)(e)&&!(0,n.isArray)(e)&&(0,r.objectEvery)(e,(e=>(0,n.isBoolean)(e)&&!!e))},t.isNumberOrEmptyString=c(n.isNumber,(e=>""===e)),t.isBooleanOrEmptyString=c(n.isBoolean,(e=>""===e)),t.isStringOrNegativeOne=c(n.isString,(e=>-1===e)),t.isRestrictions=a({b:l(n.isBoolean),p:l(n.isBoolean),c:l(n.isBoolean),f:l(n.isBoolean),o:l(n.isBoolean),e:l(n.isBoolean),fc:l(n.isBoolean),fs:l(n.isBoolean),l:l(n.isBoolean),i:l(n.isBoolean),u:l(n.isBoolean),acap:l(n.isBoolean),scap:l(n.isBoolean),imageCategory:l(n.isBoolean),pcad:l(n.isBoolean)}),t.isFlag=function(e){return 0===e||1===e||(0,n.isBoolean)(e)},t.isTrue=function(e){return!0===e},t.isFalse=function(e){return!1===e},t.isOpacity=o(0,100),t.isPointLike=s({x:n.isNumber,y:n.isNumber}),t.isBoundingBox=s({x:n.isNumber,y:n.isNumber,w:n.isNumber,h:n.isNumber}),t.isPanelSize=s({x:n.isNumber,y:n.isNumber,w:n.isNumber,h:n.isNumber,identifier:l(n.isString)}),t.isSize=s({w:n.isNumber,h:n.isNumber}),t.isPositiveNumber=function(e){return(0,n.isNumber)(e)&&e>=0},t.isDate=function(e){return e instanceof Date},t.maxLengthValidator=function(e){return t=>(0,n.isString)(t)&&t.length<=e},t.minLengthValidator=function(e){return t=>(0,n.isString)(t)&&t.length>=e},t.validatorWithMessage=function(e,t,i){return n=>e(n)?!i||i(n):t},t.asAssertion=function(e){return t=>{if(!e(t))throw new Error}}},2409:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isXHRResponse=t.isBinaryXHRResponse=t.isTextXHRResponse=void 0;const n=i(6930),r=i(7660),o=(0,r.objectValidator)({url:n.isString,status:n.isNumber,headers:(0,r.objectOfValidator)(n.isString),timeout:(0,r.option)(n.isBoolean)});t.isTextXHRResponse=(0,r.both)(o,(0,r.objectValidator)({responseFormat:(0,n.isLiteral)("utf8"),responseText:n.isString})),t.isBinaryXHRResponse=(0,r.both)(o,(0,r.objectValidator)({responseFormat:(0,n.isLiteral)("binary"),responseData:(0,n.isInstanceOf)(Uint8Array)})),t.isXHRResponse=(0,r.either)(t.isTextXHRResponse,t.isBinaryXHRResponse)},5366:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.patchCollectionIdFromPossibleBranchedCollectionId=t.branchedCollectionId=void 0,t.branchedCollectionId=function(e){return e+"_b"},t.patchCollectionIdFromPossibleBranchedCollectionId=function(e){if(e&&e.endsWith("_b"))return e.substring(0,e.length-2)}},3659:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deserializeCollectionDefinition=t.serializeCollectionDefinition=void 0;const n=i(7700);t.serializeCollectionDefinition=function(e){return{Schema:(0,n.serializeSchemaDefinition)(e.schema),Items:[...e.items.entries()]}},t.deserializeCollectionDefinition=function(e){return{schema:(0,n.parseSchemaDefinition)(e.Schema),items:new Map(e.Items)}}},5861:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CollectionUpstreamSchemaStatus=void 0,t.CollectionUpstreamSchemaStatus="__CollectionUpstreamSchemaStatus__"},1468:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CollectionProxy=void 0;const n=i(6930),r=i(4539),o=i(5999),s=i(5366),a=i(6237),l=i(3936),c=i(7700);class d extends o.PropertyStoreProxy{constructor(e,t){super(e,t),this.id=e,this.items=new r.MapProxy((()=>this.client.sendCommand("ldi",{id:this.id})),(e=>new a.DataItemProxy(e,this,this.client)))}getName(){return this.properties.get("Name")}getSyncCollectionId(){const e=this.properties.get("UpstreamConfig");if((0,n.isObjectUnsafe)(e)&&(0,n.isString)(e.SyncId))return e.SyncId}getBranchedFrom(){const e=this.properties.get("BranchedFrom");return e?new d(e,this.client):void 0}getLocalChanges(){const e=(0,s.patchCollectionIdFromPossibleBranchedCollectionId)(this.id),t=this.getBranchedFrom();if(e&&t)return new l.PatchCollectionProxy(this.client,this,new d(e,this.client),t)}patchItems(e){var t,i;const n={};if(e.changed)for(const[t,i]of e.changed)n[t]=i;return this.client.sendCommand("pdi",{id:this.id,a:null!==(t=e.added)&&void 0!==t?t:[],c:n,d:null!==(i=e.deleted)&&void 0!==i?i:[]})}getFields(){return this.client.sendCommand("lcf",{id:this.id})}getSchema(){return(0,c.parseSchemaDefinition)(this.properties.get("Schema"))}}t.CollectionProxy=d},1266:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DataError=void 0,t.DataError=class{constructor(e,t){this.error=e,this.type=t}}},6237:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DataItemProxy=void 0;const n=i(4539);t.DataItemProxy=class{constructor(e,t,i){this.primaryKey=e,this.collection=t,this.client=i,this.fields=new n.MapProxy((()=>this.client.sendCommand("lcf",{id:this.collection.id})),(e=>this.client.sendCommand("gdif",{c:this.collection.id,pk:this.primaryKey,f:e})))}exists(){return this.client.sendCommand("die",{c:this.collection.id,pk:this.primaryKey})}}},4256:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DataProxy=void 0;const n=i(4539),r=i(7807);t.DataProxy=class{constructor(e){this.client=e,this.dataSources=new n.MapProxy((()=>this.client.sendCommand("lds",void 0)),(e=>new r.DataSourceProxy(e,this.client)))}addDataSource(e,t){return new r.DataSourceProxy(this.client.sendCommand("cds",{n:e,s:t}),this.client)}}},7807:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DataSourceProxy=void 0;const n=i(6930),r=i(2939),o=i(4539),s=i(5999),a=i(1468);class l extends s.PropertyStoreProxy{constructor(e,t){super(e,t),this.id=e,this.collections=new o.MapProxy((()=>this.client.sendCommand("lc",{id:this.id})),(e=>new a.CollectionProxy(e,this.client)))}addCollection(e,t){return new a.CollectionProxy(this.client.sendCommand("cc",{s:this.id,n:e,f:t.fields.map((e=>({n:e.name,t:(0,r.serializeFieldTypeDefinition)(e.type)}))),p:t.primaryKey,fl:t.fieldLabels}),this.client)}getName(){return this.properties.get("Name")}getSourceConfig(){const e=this.properties.get("Upstream");return(0,n.isObjectUnsafe)(e)?e.SourceConfig:{}}}t.DataSourceProxy=l},9697:(e,t)=>{var i;Object.defineProperty(t,"__esModule",{value:!0}),t.DataUpdateFilterType=void 0,function(e){e.AllUpdates="AllUpdates",e.CurrentCollectionUpdates="CurrentCollectionUpdates",e.CurrentItemUpdates="CurrentItemUpdates"}(i||(t.DataUpdateFilterType=i={}))},3936:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PatchCollectionProxy=t.PatchedDataItemProxy=void 0;const n=i(6237);class r extends n.DataItemProxy{constructor(e,t,i,n,r){super(e,t,r),this.changedFields=i,this.original=n}}t.PatchedDataItemProxy=r,t.PatchCollectionProxy=class{constructor(e,t,i,n){this.client=e,this.branchedCollection=t,this.patchCollection=i,this.originalCollection=n}getAddedItems(){return this.patchCollection.items.filter(((e,t)=>!this.originalCollection.items.get(t).exists()))}getDeletedItems(){return this.originalCollection.items.filter(((e,t)=>!this.branchedCollection.items.get(t).exists()))}getChangedItems(){const e=[];for(const[t,i]of this.patchCollection.items){const n=this.originalCollection.items.get(t);if(n.exists()){const o=[];for(const[e]of i.fields)o.push(e);e.push(new r(t,this.branchedCollection,o,n,this.client))}}return e}}},3931:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseReferenceKeyDefinition=t.serializeReferenceKeyDefinition=t.isCollectionReferenceKeyDefinition=void 0;const n=i(6930),r=i(6326),o=i(7700);function s(e){return(0,n.isString)(e.collectionId)}t.isCollectionReferenceKeyDefinition=s,t.serializeReferenceKeyDefinition=function(e){return s(e)?{cid:e.collectionId,pk:e.primaryKey,wl:e.fieldWhitelist,ro:e.readonly}:{sc:(0,o.serializeSchemaDefinition)(e.schema),n:e.name,d:e.data}},t.parseReferenceKeyDefinition=function(e){if((0,r.isTypedSerializedFlattenedReference)(e))return{schema:(0,o.parseSchemaDefinition)(e.sc),name:e.n,data:e.d};if((0,r.isUnTypedSerializedFlattenedReference)(e))throw new Error("Untyped serialized flattened references not implemented");return{collectionId:e.cid,primaryKey:e.pk,fieldWhitelist:e.wl,readonly:e.ro}}},7020:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ReferenceKeyProxy=void 0;const n=i(6326),r=i(1468),o=i(3931);t.ReferenceKeyProxy=class{constructor(e,t,i,n){this.elementId=e,this.key=t,this.client=i,this.settings=n}get collectionId(){if(!(0,n.isSerializedFlattenedReference)(this.settings))return this.settings.cid}get primaryKey(){if(!(0,n.isSerializedFlattenedReference)(this.settings))return this.settings.pk}get definition(){return(0,o.parseReferenceKeyDefinition)(this.settings)}getItem(){const e=this.collectionId;if((0,n.isSerializedFlattenedReference)(this.settings)||!e)throw new Error("Not implemented for flattened references");return new r.CollectionProxy(e,this.client).items.get(this.settings.pk)}}},7700:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseSchemaDefinition=t.parseFieldDefinition=t.serializeSchemaDefinition=t.serializeFieldDefinition=t.serializeFieldConstraintDefinition=t.isFieldConstraintDefinition=t.minMaxFieldConstraintValidator=void 0;const n=i(6930),r=i(2939),o=i(9098),s=i(7660);function a(e){return e===o.FieldConstraintType.MIN_VALUE||e===o.FieldConstraintType.MAX_VALUE||e===o.FieldConstraintType.MAX_LENGTH}function l(e){return{Type:e.type,Details:e.value}}function c(e){const t={Name:e.name,Type:(0,r.serializeFieldTypeDefinition)(e.type)};return e.constraints&&(t.Constraints=e.constraints.map(l)),e.mapping&&(t.Mapping=e.mapping),t}function d(e){var t;return{name:e.Name,type:(0,r.deserializeFieldTypeDefinition)(e.Type),constraints:null===(t=e.Constraints)||void 0===t?void 0:t.map((e=>{switch(e.Type){case o.FieldConstraintType.MIN_VALUE:case o.FieldConstraintType.MAX_VALUE:case o.FieldConstraintType.MAX_LENGTH:if(!(0,n.isNumber)(e.Details))throw new Error("Invalid constraint format");return{type:e.Type,value:e.Details};case o.FieldConstraintType.REQUIRED:case o.FieldConstraintType.LOCKED:case o.FieldConstraintType.SINGLE_LINE_ONLY:case o.FieldConstraintType.NO_WHITESPACE:case o.FieldConstraintType.UNIQUE_EDIT:return{type:e.Type};default:throw new Error("Invalid constraint format")}})),mapping:e.Mapping}}t.minMaxFieldConstraintValidator=a,t.isFieldConstraintDefinition=(0,s.both)((0,s.objectValidator)({type:o.isFieldConstraintType}),(0,s.either)((0,s.objectValidator)({type:a,value:n.isNumber}),(0,s.objectValidator)({type:(0,s.exclude)(o.isFieldConstraintType,a),value:n.isUndefined}))),t.serializeFieldConstraintDefinition=l,t.serializeFieldDefinition=c,t.serializeSchemaDefinition=function(e){return{Fields:e.fields.map(c),PrimaryKey:e.primaryKey,FieldLabelOverrides:e.fieldLabels}},t.parseFieldDefinition=d,t.parseSchemaDefinition=function(e){return{fields:e.Fields.map(d),primaryKey:e.PrimaryKey,fieldLabels:e.FieldLabelOverrides}}},685:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DataConnectorManageWebhookAction=t.Webhook=t.DataConnectorPatchAction=t.Patch=t.DataConnectorSynchronousAction=t.DataConnectorAsynchronousAction=t.DataConnectorAction=t.DataConnectorActionContext=void 0;const n=i(6122),r=i(306);t.DataConnectorActionContext=class{constructor(e,t,i,n,r,o,s){this.packageId=e,this.packageVersion=t,this.userCredential=i,this.dataConnectorName=n,this.installationId=r,this.documentCollections=o,this.updateFilterType=s}};class o{constructor(e,t){this.name=e,this.context=t}}t.DataConnectorAction=o,t.DataConnectorAsynchronousAction=class extends o{constructor(e,t,i,n){super(e,t),this.client=i,this.data=n}},t.DataConnectorSynchronousAction=class extends o{constructor(e,t,i){super(e,t),this.data=i}},t.Patch=class{constructor(e,t,i,n,r,o,s){this.id=e,this.itemsAdded=t,this.itemsChanged=i,this.itemsDeleted=n,this.itemOrderChanged=r,this.syncSourceId=o,this.syncCollectionId=s}getChange(e=[]){return new r.PatchChange(this.id,this.syncSourceId,e)}toJSON(){return{Id:this.id,ItemsAdded:this.itemsAdded,ItemsChanged:this.itemsChanged,ItemsDeleted:this.itemsDeleted,ItemOrderChanged:this.itemOrderChanged,SyncSourceId:this.syncSourceId,SyncCollectionId:this.syncCollectionId}}},t.DataConnectorPatchAction=class extends o{constructor(e,t,i,r=n.DataConnectorActionKeys.Patch){super(r,e),this.patches=t,this.client=i}},t.Webhook=class{constructor(e,t){this.documentCollections=e,this.webhookData=t}},t.DataConnectorManageWebhookAction=class extends o{constructor(e,t,i){super(n.DataConnectorActionKeys.ManageWebhook,e),this.webhookToken=t,this.webhooks=i}}},6122:(e,t)=>{var i;Object.defineProperty(t,"__esModule",{value:!0}),t.DataConnectorActionKeys=void 0,function(e){e.ManageWebhook="ManageWebhook",e.Patch="Patch",e.UnbatchedPatch="UnbatchedPatch"}(i||(t.DataConnectorActionKeys=i={}))},932:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.serializeManageWebhookResponse=void 0,t.serializeManageWebhookResponse=function(e){return{documentCollections:e.documentCollections,webhookData:e.webhookData}}},306:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.serializePatchChanges=t.serializePatchResponse=t.PatchErrorTooltipField=t.PatchChange=void 0;const n=i(1292),r=i(6298);function o(e){return{syncId:e.syncId,collections:e.collections.map((e=>({collectionId:e.collectionId,itemsPatch:(0,r.serializeItemsPatch)(e.itemsPatch)})))}}t.PatchChange=class{constructor(e,t,i){this.patchId=e,this.syncId=t,this.collections=i,this.errors={}}setError(e,t,i){e in this.errors||(this.errors[e]={}),this.errors[e][t]=i}setTooltipError(e,i){this.setError(e,t.PatchErrorTooltipField,i)}getErrors(){return this.errors}},t.PatchErrorTooltipField="__canvasTooltipDataSyncError__",t.serializePatchResponse=o,t.serializePatchChanges=function(e){const t={};for(const i of e)for(const e of i)for(const[i,n]of Object.entries(e.getErrors()))for(const[r,o]of Object.entries(n)){e.patchId in t||(t[e.patchId]={});const n=t[e.patchId];i in n||(n[i]={}),n[i][r]=o}return{changes:(0,n.flatten)(e.map((e=>e.map((e=>o(e)))))),errors:t}}},8310:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deserializeActions=t.actionsHeaderValidator=void 0;const n=i(6930),r=i(7660),o=i(9697),s=i(685),a=i(6122);t.actionsHeaderValidator=(0,r.objectValidator)({"x-lucid-rsa-nonce":n.isString,"x-lucid-signature":n.isString});const l=(0,r.objectValidator)({action:(0,r.objectValidator)({name:n.isString,data:n.isUnknown}),packageId:n.isString,packageVersion:(0,r.nullableOption)(n.isString),dataConnectorName:n.isString,installationId:(0,r.nullableOption)(n.isString),userCredential:(0,r.nullableOption)(n.isString),documentUpdateToken:(0,r.nullableOption)(n.isString),documentCollections:(0,r.objectOfValidator)((0,r.arrayValidator)(n.isString)),updateFilterType:(0,r.enumValidator)(o.DataUpdateFilterType)}),c=(0,r.objectValidator)({packageVersion:n.isString,patches:(0,r.arrayValidator)((0,r.objectValidator)({patch:(0,r.objectValidator)({itemsAdded:(0,r.objectOfValidator)(n.isObjectUnsafe),itemsChanged:(0,r.objectOfValidator)(n.isObjectUnsafe),itemsDeleted:(0,r.arrayValidator)(n.isString),itemOrderChanged:(0,r.nullableOption)((0,r.arrayValidator)((0,r.tupleValidator)(n.isString,(0,r.nullable)(n.isString)))),syncSourceId:n.isString,syncCollectionId:n.isString,adapterType:(0,n.isLiteral)("EXTENSION_API"),syncSchema:n.isUnknown}),id:n.isString})),userCredential:n.isString,documentUpdateToken:n.isString}),d=e=>e.map((e=>{var t;const i=e.patch;return new s.Patch(e.id,i.itemsAdded,i.itemsChanged,i.itemsDeleted,null!==(t=i.itemOrderChanged)&&void 0!==t?t:void 0,i.syncSourceId,i.syncCollectionId)})),u=(0,r.objectValidator)({webhooks:(0,r.arrayValidator)((0,r.objectValidator)({documentCollections:(0,r.objectOfValidator)((0,r.arrayValidator)(n.isString)),webhookData:(0,r.option)(n.isUnknown)})),webhookToken:n.isString});t.deserializeActions=function(e,t){if(!l(t))return;const i=t.action.name,n=t.action.data;if(i===a.DataConnectorActionKeys.Patch)return(0,r.arrayValidator)(c)(n)?n.map((i=>{const n=new s.DataConnectorActionContext(t.packageId,i.packageVersion,i.userCredential,t.dataConnectorName,t.dataConnectorName,t.documentCollections,t.updateFilterType),r=d(i.patches);return new s.DataConnectorPatchAction(n,r,e.getDataSourceClient(i.documentUpdateToken))})):void console.log("Failing validation step");if(!t.packageVersion||!t.userCredential)return;if(i===a.DataConnectorActionKeys.UnbatchedPatch){if(!c(n))return;const i=new s.DataConnectorActionContext(t.packageId,t.packageVersion,t.userCredential,t.dataConnectorName,t.dataConnectorName,t.documentCollections,t.updateFilterType);return[new s.DataConnectorPatchAction(i,d(n.patches),e.getDataSourceClient(n.documentUpdateToken),a.DataConnectorActionKeys.UnbatchedPatch)]}const o=new s.DataConnectorActionContext(t.packageId,t.packageVersion,t.userCredential,t.dataConnectorName,t.dataConnectorName,t.documentCollections,t.updateFilterType);if("ManageWebhook"==i){if(!u(n))return;const e=n.webhooks.map((e=>new s.Webhook(e.documentCollections,e.webhookData)));return[new s.DataConnectorManageWebhookAction(o,n.webhookToken,e)]}return t.documentUpdateToken?[new s.DataConnectorAsynchronousAction(i,o,e.getDataSourceClient(t.documentUpdateToken),n)]:[new s.DataConnectorSynchronousAction(i,o,n)]}},4444:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DataConnector=t.DataConnectorResponseError=t.DataConnectorRequestState=t.DataConnectorRequestError=t.DataConnectorRunError=void 0;const n=i(6930),r=i(7660),o=i(685),s=i(6122),a=i(932),l=i(306),c=i(4599),d=i(3981);class u extends Error{constructor(e,t,i){super(null!=i?i:JSON.stringify(t)),this.status=e,this.body=t}static withMessage(e,t){return new u(e,{error:t},t)}}t.DataConnectorRunError=u;class h extends Error{constructor(e,t,i,n){super(t),this.status=e,this.response=i,this.statusText=n}toString(){return`${this.message} ${this.statusText?this.statusText+" ":""}(${this.status}) ${this.response}`}}t.DataConnectorRequestError=h;class p{constructor(e){this.itemRekeyer=e}}t.DataConnectorRequestState=p;class m extends Error{constructor(e,t){super(e),this.response=t}}t.DataConnectorResponseError=m,t.DataConnector=class{constructor(e){this.client=e,this.actions={},this.routes={}}defineAction(e,t,i=!1){return this.actions[e]={actionResponder:t,asynchronous:i},this}defineAsynchronousAction(e,t){return this.defineAction(e,t,!0)}defineRoute(e,t){return this.routes[e]=t,this}async runAction(e,t,i){const n=new p(new d.ItemRekeyer),r=await this.client.parseActions(e,t,i);if(!r)return console.warn("Received bad request",e,t,i),{status:404,body:{error:"Bad request"}};const c=r[0].name;try{const e=[];for(const t of r){if(!(t.name in this.actions))throw u.withMessage(404,`Action ${t.name} is not implemented`);const{actionResponder:i,asynchronous:r}=this.actions[t.name],s=(()=>{if(r){if(!(t instanceof o.DataConnectorAsynchronousAction))throw u.withMessage(400,`Passing uncredentialed action to ${t.name} which is defined to be asynchronous`);return i(t,n)}return i(t,n)})();e.push(await s)}if(c===s.DataConnectorActionKeys.ManageWebhook){const t=e[0];return{status:200,body:(0,a.serializeManageWebhookResponse)(t)}}if(c===s.DataConnectorActionKeys.Patch||c===s.DataConnectorActionKeys.UnbatchedPatch){const t=e;return{status:200,body:(0,l.serializePatchChanges)(t)}}return 1===e.length?{status:200,body:e[0]}:{status:200,body:e}}catch(e){return(console.error?console.error:console.log)(`Error running ${c} action`,e),y(e)?{status:e.status,body:e.body}:{status:500,body:{error:`error running ${c} action`}}}}routeDebugServer(e){return(0,c.routeDebugServer)(this,e)}runDebugServer(e){(0,c.runDebugServer)(this,e)}};const y=(0,r.objectValidator)({status:n.isNumber,body:n.isUnknown})},8399:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MockDataConnectorClient=t.DataConnectorClient=void 0;const n=i(6930),r=i(8310),o=i(53),s=i(4228),a=i(851),l=i(5718),c={main:"https://lucid.app/",api:"https://api.lucid.co/"};class d{constructor(e,t=c,i=s.globalFetch){this.cryptoDependencies=e,this.urls=t,this.fetchMethod=i,this.cachedPublicKey=void 0}getDataSourceClient(e){return new o.DataSourceClient(this.urls,e,this.fetchMethod)}async getSignatureValidator(){return new a.SignatureValidator(this.cryptoDependencies,await this.getPublicKey())}async getPublicKey(){if(!this.cachedPublicKey){const e=`${this.urls.main}.well-known/pem/TPCP`,t=await this.fetchMethod(e);await(0,l.throwUnsuccessful)(t,"getting public key"),this.cachedPublicKey=await t.text()}return this.cachedPublicKey}async parseActions(e,t,i){if((0,r.actionsHeaderValidator)(t)&&(await this.getSignatureValidator()).validate(i,t,e))return(0,r.deserializeActions)(this,i)}async getSecretFromWebhook(e,t){const i=await this.fetchMethod(`${this.urls.dataSync}webhookAuthorization`,{headers:{"data-update-token":e,"webhook-validation-secret":JSON.stringify(t)}});await(0,l.throwUnsuccessful)(i,"getting secret from webhook");const r=await i.json();return(0,n.isString)(r)?r:void 0}async getCustomWebhookData(e){const t=await this.fetchMethod(`${this.urls.dataSync}customWebhookData`,{headers:{"data-update-token":e}});return await(0,l.throwUnsuccessful)(t,"getting custom webhook data"),await t.json()}async patchCustomWebhookData(e,t){const i=await this.fetchMethod(`${this.urls.dataSync}customWebhookData`,{method:"PATCH",headers:{"Content-Type":"application/json","data-update-token":e,"Lucid-Api-Version":"1"},body:JSON.stringify(t)});return await(0,l.throwUnsuccessful)(i,"patching custom webhook data"),await i.json()}}t.DataConnectorClient=d,t.MockDataConnectorClient=class extends d{constructor(){super(void 0),this.dataSourceClient=new o.MockDataSourceClient}getDataSourceClient(e){return this.dataSourceClient}getSignatureValidator(){return Promise.resolve(new a.MockSignatureValidator)}getPublicKey(){return Promise.resolve("")}}},53:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MockDataSourceClient=t.DataSourceClient=void 0;const n=i(6930),r=i(639),o=i(7457),s=i(9002),a=i(7346),l=i(7660),c=i(4444),d=i(2502),u=i(6298),h=i(4228),p=i(5718);class m{constructor(e,t,i=h.globalFetch){this.urls=e,this.updateToken=t,this.fetchMethod=i;const r=e.dataSync;this.metadataUrl=(0,n.isString)(r)?`${r}dataSource/metadata`:void 0}formatBody({dataSourceName:e,collections:t,updateFilterType:i,dataSourceConfiguration:n}){const a={};for(const e in t)a[e]=(0,u.serializeCollectionPatch)(t[e]);const l=i?{UpdateFilterType:i}:{},c={dataSourceType:r.DataSourceType.DataService,updateType:s.UpstreamUpdateType.EVENTPULL,patchType:null==n?void 0:n.patchType,sourceConfig:Object.assign({},l)};return{updateData:a,name:e,upstreamConfig:(0,o.serializeUpstreamConfig)(c)}}async update(e){const t=await this.fetchMethod(`${this.urls.api}data/dataSource/update`,{method:"POST",headers:{"Content-Type":"application/json","data-update-token":this.updateToken,"Lucid-Api-Version":"1"},body:JSON.stringify(this.formatBody(e))});await(0,p.throwUnsuccessful)(t,"updating data source")}getLengthLimitedQueryParams(e,t){const i=e.map(encodeURIComponent).map((e=>`metadataKeys=${e}`)),n=t.map(encodeURIComponent).map((e=>`metadataPrefixes=${e}`)),r=[];let o="",s="?";return[...i,...n].forEach((e=>{o=o.concat(`${s}${e}`),o.length>2e3?(r.push(o),o="",s="?"):s="&"})),o.length>0&&r.push(o),r}async getResponseOrError(e){const t=await this.fetchMethod(e,{method:"GET",headers:{"Content-Type":"application/json","data-update-token":this.updateToken,"Lucid-Api-Version":"1"}});try{await(0,p.throwUnsuccessful)(t,"getting data source`s metadata")}catch(t){if(t instanceof c.DataConnectorResponseError)return{error:{url:e,body:t.response}};throw t}const i=await t.json();return(0,l.arrayValidator)(d.isSerializedMetadataRecord)(i)?{value:i.map((e=>({key:e.key,value:e.value})))}:{error:{url:e,body:i}}}async getMetadata(e,t=[]){if(null==this.metadataUrl)throw new Error("Attempted to access data sync service metadata endpoints in environment where the URL does not exist!");const i=this.getLengthLimitedQueryParams(e,t).map((e=>`${this.metadataUrl}${e}`)).map((e=>this.getResponseOrError(e))),n=await Promise.all(i),r=[],o=[];if(n.forEach((e=>{(0,a.isSuccess)(e)?r.push(...e.value):o.push(e.error)})),o.length>0){const e=`Error(s) received accessing URL(s): ${o.map((({url:e})=>e)).join(",")}`,t=o.map((({body:e})=>e));throw new c.DataConnectorResponseError(e,JSON.stringify(t))}return r}async patchMetadata(e){if(null==this.metadataUrl)throw new Error("Attempted to access data sync service metadata endpoints in environment where the URL does not exist!");const t=e.map((e=>({key:e.key,oldValue:e.oldValue,newValue:e.newValue}))),i=await this.fetchMethod(this.metadataUrl,{method:"PATCH",headers:{"Content-Type":"application/json","data-update-token":this.updateToken,"Lucid-Api-Version":"1"},body:JSON.stringify(t)});if(409===i.status){const e=await i.json();if((0,l.arrayValidator)(d.isSerializedMetadataRecord)(e))return{status:"Conflict",records:e.map((e=>({key:e.key,value:e.value})))};throw new c.DataConnectorResponseError(`Invalid conflict response to query at '${this.metadataUrl}'! Expected an array of serialized metadata records`,JSON.stringify(e))}return await(0,p.throwUnsuccessful)(i,"patching data source`s metadata"),{status:"NoContent"}}}t.DataSourceClient=m,t.MockDataSourceClient=class extends m{constructor(){super({main:"",api:""},""),this.gotUpdate=e=>{throw new Error(`Didn't mock request: ${JSON.stringify(e)}`)},this.gotMetadata=e=>{throw new Error(`Didn't mock request: ${JSON.stringify(e)}`)},this.patchedMetadata=e=>{throw new Error(`Didn't mock request: ${JSON.stringify(e)}`)}}update(e){return Promise.resolve(this.gotUpdate(e))}getMetadata(e,t=[]){return Promise.resolve(this.gotMetadata(e,t))}patchMetadata(e){return Promise.resolve(this.patchedMetadata(e))}}},2502:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isSerializedMetadataRecord=void 0;const n=i(6930),r=i(7660);t.isSerializedMetadataRecord=(0,r.objectValidator)({key:n.isString,value:n.isUnknown})},6298:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.schemaOKStatus=t.schemaOutOfSyncStatus=t.serializeCollectionPatch=t.serializeFieldDefinitionForApi=t.serializeItemsPatch=t.ItemsPatchExhaustive=t.ItemsPatchInexhaustive=void 0;const n=i(6930),r=i(2939),o=i(1292),s=i(5861);class a{constructor(e,t,i){this.items=e,this.itemsDeleted=t,this.errors=i,this._brand=a}}t.ItemsPatchInexhaustive=a;class l{constructor(e,t,i){this.items=e,this.rekeyingMap=t,this.errors=i,this._brand=l}}function c(e){return e&&{errors:(0,o.fromEntries)(e)}}function d(e){var t,i;return e instanceof l?Object.assign(Object.assign({exhaustiveItems:(0,o.fromEntries)(e.items.entries())},(i=e.rekeyingMap)&&{rekeyingMap:(0,o.fromEntries)(i)}),c(e.errors)):Object.assign({items:(0,o.fromEntries)(e.items.entries()),itemsDeleted:null!==(t=e.itemsDeleted)&&void 0!==t?t:[]},c(e.errors))}function u(e){var t;return{name:e.name,type:(0,r.serializeFieldTypeDefinition)(e.type),constraints:(null!==(t=e.constraints)&&void 0!==t?t:[]).map((e=>{return{type:(t=e).type,details:t.value};var t})),mapping:e.mapping}}t.ItemsPatchExhaustive=l,t.serializeItemsPatch=d,t.serializeFieldDefinitionForApi=u,t.serializeCollectionPatch=function(e){const t=e.represents&&{Represents:e.represents},i=(0,n.isString)(e.name)?{Name:e.name}:void 0,r=(t||i)&&Object.assign(Object.assign({},t),i);return{schema:e.schema&&(o=e.schema,{fields:o.fields.map((e=>u(e))),primaryKey:o.primaryKey,fieldLabelOverrides:o.fieldLabels}),itemsPatch:d(e.patch),properties:r};var o},t.schemaOutOfSyncStatus=function(e,t){return[s.CollectionUpstreamSchemaStatus,{dict:{status:"broken",onDocumentKey:JSON.stringify(e),upstreamKey:JSON.stringify(t)}}]},t.schemaOKStatus=function(){return[s.CollectionUpstreamSchemaStatus,{dict:{status:"ok",onDocumentKey:null,upstreamKey:null}}]}},4599:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.runDebugServer=t.routeDebugServer=void 0;const n=i(1292);function r(e,t){var i,r;const{express:o}=t,s=null!==(i=t.app)&&void 0!==i?i:t.express();s.use(o.raw({type:()=>!0,limit:"100mb"})),s.use(((e,t,i)=>{var n,r;(null===(r=null===(n=e.headers)||void 0===n?void 0:n.origin)||void 0===r?void 0:r.match(/.lucid(dev|staging|preprod|gov|govpreprod|).app$/))&&(t.header("Access-Control-Allow-Origin",e.headers.origin),t.header("Vary","Origin"),t.header("Access-Control-Allow-Methods","GET, OPTIONS"),t.header("Access-Control-Allow-Headers","*")),i()}));const a=null!==(r=t.prefix)&&void 0!==r?r:"/";if(console.log(`Routing ${a} (${Object.keys(e.actions).join(", ")})`),e.routes)for(const t of Object.keys(e.routes))console.log(`Routing ${a}?kind=route&name=${t}`);return s.post(a,(async(t,i)=>{try{const r=t.query.kind;if("action"===r||null==r||""===r){const{body:n,status:r}=await e.runAction(t.url,t.headers,JSON.parse(t.body.toString()));i.status(r).json(n)}if("route"===r){const r=t.query.name;if("string"==typeof r){const o=e.routes[r],s=t.headers,{body:a,status:l,headers:c}=await o({body:t.body.toString(),headers:s,query:(0,n.fromEntries)(Object.entries(t.query).map((([e,t])=>[e,"string"==typeof t?t:void 0])))});for(const[e,t]of Object.entries(null!=c?c:{}))"string"==typeof t&&i.setHeader(e,t);i.status(l),i.send(a)}}}catch(e){console.log(`Error serving Connector: ${a} Flow: ${t.query.name}, Exception:`,e),i.status(500).end()}})),s}t.routeDebugServer=r,t.runDebugServer=function(e,t){var i;const n=null!==(i=t.port)&&void 0!==i?i:3001,o=r(e,t).listen(n,(()=>{const e=o.address(),t="string"==typeof e?e:null==e?void 0:e.port;console.log(`Listening on port ${t}`)}))}},4228:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.globalFetch=void 0,t.globalFetch=globalThis.fetch},3981:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ItemRekeyer=t.RekeyingMap=void 0;const n=i(5463),r=i(1292),o=i(685),s=i(6298);class a{constructor(e){this.map=e}getNewKey(e){var t;return null!==(t=this.map.get(e))&&void 0!==t?t:e}getRecordWithNewKeys(e){return(0,r.fromEntries)(Object.entries(e).map((([e,t])=>[this.getNewKey(e),t])))}getRekeyedPatch(e){var t;return new o.Patch(e.id,this.getRecordWithNewKeys(e.itemsAdded),this.getRecordWithNewKeys(e.itemsChanged),e.itemsDeleted.map((e=>this.getNewKey(e))),null===(t=e.itemOrderChanged)||void 0===t?void 0:t.map((([e,t])=>[this.getNewKey(e),t&&this.getNewKey(t)])),e.syncSourceId,e.syncCollectionId)}}t.RekeyingMap=a,t.ItemRekeyer=class{constructor(){this.rekeyingMaps=new Map}addRekeyingsFor(e,t,i){var r;const o=function(e,t){var i,r;if(e instanceof s.ItemsPatchExhaustive)return e.rekeyingMap;{if(!t)return;const o=t;function a(e,t){const i=o.elements.map((e=>t[e]));if(void 0===i.find((e=>void 0!==e)))return;const r=JSON.parse(`[${e}]`),s=i.map(((e,t)=>void 0!==e?e:r[t])),a=n.FormattedPrimaryKey.serializeList(s);return a!==e?a:void 0}const l=[...e.items.entries()].map((([e,t])=>[e,a(e,t)])).filter((e=>void 0!==e[1])),c=null!==(r=null===(i=e.itemsDeleted)||void 0===i?void 0:i.map((e=>[e,null])))&&void 0!==r?r:[],d=new Map([...l,...c]);return d.size>0?d:void 0}}(t,i);if(o){const t=this.rekeyingMaps.get(e),i=[...null!==(r=null==t?void 0:t.map.entries())&&void 0!==r?r:[]].map((([e,t])=>{var i;return[e,t&&(null!==(i=o.get(t))&&void 0!==i?i:t)]}));this.rekeyingMaps.set(e,new a(new Map([...o.entries(),...i])))}}getRekeyingMap(e){return this.rekeyingMaps.get(e.syncCollectionId)}}},851:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MockSignatureValidator=t.SignatureValidator=void 0,t.SignatureValidator=class{constructor(e,t){this.dependencies=e,this.publicKey=e.crypto.createPublicKey(t)}validate(e,t,i){const[,n=""]=i.split("?"),r=t["x-lucid-rsa-nonce"],o=this.dependencies.Buffer.from(t["x-lucid-signature"],"base64"),s=this.dependencies.Buffer.from(JSON.stringify(e)+r+n);return this.dependencies.crypto.verify("SHA384",s,this.publicKey,o)}},t.MockSignatureValidator=class{validate(){return!0}}},5718:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.throwUnsuccessful=void 0;const n=i(4444);t.throwUnsuccessful=async function(e,t){if(2!==Math.floor(e.status/100))throw new n.DataConnectorRequestError(e.status,t,await e.text(),e.statusText)}},4593:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.findProxyClass=void 0;const n=i(4936),r=i(9721),o=i(4607),s=i(1895),a=i(6202),l=i(6404),c=i(9642),d=[n.CardBlockProxy,r.CustomBlockProxy,o.ERDBlockProxy,s.LegendBlockProxy,a.LinkUnfurlBlockProxy,l.SwimLaneBlockProxy,c.TableBlockProxy];t.findProxyClass=function(e){return d.find((t=>t.classNameRegex.test(e)))}},4936:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CardBlockProxy=void 0;const n=i(2203),r=i(6874);class o extends r.BlockProxy{getSettings(){return this.referenceKeys.get(this.referenceKeys.keys()[0]).definition}getTitle(){return this.getSettings().data[n.LucidCardFields.Title]}getDescription(){return this.getSettings().data[n.LucidCardFields.Description]}getStatus(){return this.getSettings().data[n.LucidCardFields.Status]}getAssignee(){return this.getSettings().data[n.LucidCardFields.Assignee]}getStartTime(){return this.getSettings().data[n.LucidCardFields.StartTime]}getEndTime(){return this.getSettings().data[n.LucidCardFields.EndTime]}getEstimate(){return this.getSettings().data[n.LucidCardFields.Estimate]}setTitle(e){const t=this.getSettings();t.data[n.LucidCardFields.Title]=e,this.setReferenceKey(this.referenceKeys.keys()[0],t)}setDescription(e){const t=this.getSettings();t.data[n.LucidCardFields.Description]=e,this.setReferenceKey(this.referenceKeys.keys()[0],t)}setStatus(e){const t=this.getSettings();t.data[n.LucidCardFields.Status]=e,this.setReferenceKey(this.referenceKeys.keys()[0],t)}setAssignee(e){const t=this.getSettings();t.data[n.LucidCardFields.Assignee]=e,this.setReferenceKey(this.referenceKeys.keys()[0],t)}setStartTime(e){const t=this.getSettings();t.data[n.LucidCardFields.StartTime]=e,this.setReferenceKey(this.referenceKeys.keys()[0],t)}setEndTime(e){const t=this.getSettings();t.data[n.LucidCardFields.EndTime]=e,this.setReferenceKey(this.referenceKeys.keys()[0],t)}setEstimate(e){const t=this.getSettings();t.data[n.LucidCardFields.Estimate]=e,this.setReferenceKey(this.referenceKeys.keys()[0],t)}}t.CardBlockProxy=o,o.classNameRegex=/^LucidCardBlock$/},9721:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CustomBlockProxy=void 0;const n=i(6930),r=i(6874);class o extends r.BlockProxy{static registerCustomBlockClass(e){let t=o.subclassRegistry.get(e.library);t||(t=new Map,o.subclassRegistry.set(e.library,t)),t.set(e.shape,e)}static getCustomBlockClass(e,t){if(this.subclassRegistry.size>0){const i=e.sendCommand("gp",{id:t,p:"Stencil"});if((0,n.isObjectUnsafe)(i)){const t=e.sendCommand("gp",{p:"Stencil-"+i.id});if((0,n.isObjectUnsafe)(t)&&(0,n.isObjectUnsafe)(t.sourcePackage)&&t.sourcePackage.packageId===lucid.getPackageId()){const e=o.subclassRegistry.get(String(t.sourcePackage.library)),i=null==e?void 0:e.get(String(t.sourcePackage.shape));if(i)return i}}}return o}isFromStencil(e,t){const i=this.properties.get("Stencil");if((0,n.isObjectUnsafe)(i)){const r=this.client.sendCommand("gp",{p:"Stencil-"+i.id});if((0,n.isObjectUnsafe)(r)&&(0,n.isObjectUnsafe)(r.sourcePackage))return r.sourcePackage.packageId===lucid.getPackageId()&&r.sourcePackage.library===e&&r.sourcePackage.shape===t}return!1}getStencilTextAreaName(e){return this.textAreas.keys().find((t=>t.endsWith("_"+e)))}}t.CustomBlockProxy=o,o.classNameRegex=/^CustomBlock$/,o.subclassRegistry=new Map},4607:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ERDBlockProxy=t.ERDFieldProxy=void 0;const n=i(6874);class r{constructor(e,t){this.block=e,this.index=t}getName(){return this.block.properties.get("Field"+this.index)}getType(){var e;return null!==(e=this.block.properties.get("Type"+this.index))&&void 0!==e?e:""}getKey(){var e;return null!==(e=this.block.properties.get("Key"+this.index))&&void 0!==e?e:""}}t.ERDFieldProxy=r;class o extends n.BlockProxy{getName(){return this.properties.get("Name")}getFieldCount(){return this.properties.get("Fields")}getFields(){const e=[],t=this.getFieldCount();for(let i=1;i<=t;i++)e.push(new r(this,i));return e}}t.ERDBlockProxy=o,o.classNameRegex=/^ERDEntityBlock(2|3|4)?$/},1895:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LegendBlockProxy=t.ShapeLegendEntryProxy=t.ColorLegendEntryProxy=t.LegendEntryProxy=t.LegendItemType=void 0;const n=i(6874);var r;!function(e){e.Color="color",e.Shape="shape"}(r||(t.LegendItemType=r={}));class o{constructor(e,t,i){this.legend=e,this.index=t,this.type=i}getText(){return this.legend.textAreas.get("LegendText_"+this.index)}setText(e){this.legend.textAreas.set("LegendText_"+this.index,e)}}t.LegendEntryProxy=o;class s extends o{constructor(e,t){super(e,t,r.Color)}getColor(){return this.legend.properties.get("LegendItem_"+this.index).Value}}t.ColorLegendEntryProxy=s;class a extends o{constructor(e,t){super(e,t,r.Shape)}}t.ShapeLegendEntryProxy=a;class l extends n.BlockProxy{getHeader(){return this.textAreas.get("t_header")}getItems(){return this.properties.get("ItemOrder").map((e=>{const t=this.properties.get("LegendItem_"+e);switch(t.Type){case r.Color:return new s(this,e);case r.Shape:return new a(this,e);default:return new o(this,e,t.Type)}}))}}t.LegendBlockProxy=l,l.classNameRegex=/^LegendBlockV2$/},6202:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ExperimentalLinkUnfurlBlockProxy=t.LinkUnfurlBlockProxy=void 0;const n=i(7909),r=i(3578),o=i(6874);class s extends o.BlockProxy{getTitle(){return this.textAreas.get("t_LinkUnfurlTitle")}setTitle(e){this.textAreas.set("t_LinkUnfurlTitle",e,{force:!0})}getDescription(){return this.textAreas.get("t_LinkUnfurlDescription")}setDescription(e){this.textAreas.set("t_LinkUnfurlDescription",e,{force:!0})}getProviderName(){return this.textAreas.get("t_LinkUnfurlProviderName")}getUrl(){return this.properties.get("LinkUnfurlUrl")}setUrl(e){this.properties.set("LinkUnfurlUrl",e)}setIframe(e){const t=(0,r.generateIframeAttributes)(e);this.properties.set("LinkUnfurlIframeHtml",(0,n.generateIFrameHTML)(t)),this.properties.set("LinkUnfurlIframeHeight",t.height),this.properties.set("LinkUnfurlIframeWidth",t.width)}hasIframe(){return!!this.properties.get("LinkUnfurlIframeHtml")}setPreviewThumbnailUrl(e){this.properties.set("LinkUnfurlThumbnailUrl",e)}getPreviewThumbnailUrl(){return this.properties.get("LinkUnfurlThumbnailUrl")}setThumbnailUrls(e){this.properties.set("LinkUnfurlThumbnailUrls",e)}getFaviconUrl(){return this.properties.get("LinkUnfurlFaviconUrl")}setFaviconUrl(e){this.properties.set("LinkUnfurlFaviconUrl",e)}async experimentalStartPDFUpload(){return await this.client.sendCommand("pdf",this.id)}}t.LinkUnfurlBlockProxy=s,s.classNameRegex=/^LinkUnfurlBlock$/,t.ExperimentalLinkUnfurlBlockProxy=s},6404:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SwimLaneBlockProxy=t.SwimLanePrimaryLaneProxy=void 0;const n=i(8333),r=i(6874);class o{constructor(e,t){this.swimlane=e,this.index=t}getSize(){return this.swimlane.getPrimaryLaneSizes()[this.index]}getBoundingBox(){const e=this.swimlane.getBoundingBox(),t=this.swimlane.getPrimaryLaneSizes();return this.swimlane.getPrimaryLanesVertical()?{x:e.x+t.slice(0,this.index).reduce(((e,t)=>e+t),0),y:e.y,w:t[this.index],h:e.h}:{x:e.x,y:e.y+t.slice(0,this.index).reduce(((e,t)=>e+t),0),w:e.w,h:t[this.index]}}getTitleTextAreaId(){return this.swimlane.properties.get("PrimaryLaneTextAreaIds")[this.index]||(this.swimlane.updateTextAreaNames(),this.swimlane.properties.get("PrimaryLaneTextAreaIds")[this.index])}getTitle(){return this.swimlane.textAreas.get(this.getTitleTextAreaId())}setTitle(e){return this.swimlane.textAreas.set(this.getTitleTextAreaId(),e)}setFill(e){this.swimlane.properties.set(`CellFill_0,${this.index}`,(0,n.serializeSimpleFill)(e))}}t.SwimLanePrimaryLaneProxy=o;class s extends r.BlockProxy{getPrimaryLaneSizes(){return this.properties.get("PrimaryLane")}setPrimaryLaneSizes(e){this.properties.set("PrimaryLane",e),this.updateTextAreaNames()}getPrimaryLanes(){return this.getPrimaryLaneSizes().map(((e,t)=>new o(this,t)))}getPrimaryLanesVertical(){return this.properties.get("IsPrimaryLaneVertical")}getMagnetized(){return this.properties.get("Magnetize")}setMagnetized(e){this.properties.set("Magnetize",e)}updateTextAreaNames(){this.properties.set("PrimaryLaneTextAreaIds",this.getPrimaryLaneSizes().map(((e,t)=>"Primary_"+t)))}setBoundingBox(e){super.setBoundingBox(e);const t=this.getBoundingBox(),i=this.getPrimaryLaneSizes(),n=this.properties.get("SecondaryLane"),r=(e,t,i=e.length-1)=>{if(i>=0&&i<e.length&&(e[i]+=t,e[i]<40)){const t=40-e[i];e[i]=40,r(e,t,i-1)}};e.w!=t.w&&(this.getPrimaryLanesVertical()?(r(i,e.w-t.w),this.setPrimaryLaneSizes(i)):(r(n,e.w-t.w),this.properties.set("SecondaryLane",n))),e.h!=t.h&&(this.getPrimaryLanesVertical()?(r(n,e.h-t.h),this.properties.set("SecondaryLane",n)):(r(i,e.h-t.h),this.setPrimaryLaneSizes(i)))}}t.SwimLaneBlockProxy=s,s.classNameRegex=/^AdvancedSwimLaneBlock$/},9642:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TableBlockProxy=t.TableColumnProxy=t.TableRowProxy=t.TableCellProxy=void 0;const n=i(8333),r=i(6874);class o{constructor(e,t,i){this.table=e,this.row=t,this.column=i}getText(){return this.table.textAreas.get(`Cell_${this.row},${this.column}`)}setText(e){return this.table.textAreas.set(`Cell_${this.row},${this.column}`,e)}getTextStyle(){return this.table.textStyles.get(`Cell_${this.row},${this.column}`)}setTextStyle(e){this.table.textStyles.set(`Cell_${this.row},${this.column}`,e)}setFill(e){this.table.properties.set(`CellFill_${this.row},${this.column}`,(0,n.serializeSimpleFill)(e))}getMergedCellSize(){var e;return null!==(e=this.table.properties.get(`CellSize_${this.row},${this.column}`))&&void 0!==e?e:{w:1,h:1}}setMergedCellSize(e){this.table.properties.set(`CellSize_${this.row},${this.column}`,e)}getWidth(){return this.table.getColumnWidths().slice(this.column,this.column+this.getMergedCellSize().w).reduce(((e,t)=>e+t),0)}getHeight(){return this.table.getRowHeights().slice(this.row,this.row+this.getMergedCellSize().h).reduce(((e,t)=>e+t),0)}getBoundingBox(){const e=this.table.getBoundingBox();return{x:e.x+this.table.getColumnWidths().slice(0,this.column).reduce(((e,t)=>e+t),0),y:e.y+this.table.getRowHeights().slice(0,this.row).reduce(((e,t)=>e+t),0),w:this.getWidth(),h:this.getHeight()}}}t.TableCellProxy=o;class s{constructor(e,t){this.table=e,this.row=t}getCells(){return this.table.getColumnWidths().map(((e,t)=>new o(this.table,this.row,t)))}getHeight(){var e;return null!==(e=this.table.getRowHeights()[this.row])&&void 0!==e?e:1}}t.TableRowProxy=s;class a{constructor(e,t){this.table=e,this.col=t}getCells(){return this.table.getRowHeights().map(((e,t)=>new o(this.table,this.col,t)))}getWidth(){var e;return null!==(e=this.table.getColumnWidths()[this.col])&&void 0!==e?e:1}}t.TableColumnProxy=a;class l extends r.BlockProxy{addColumn(e,t=!1){const i=this.client.sendCommand("atc",{id:this.id,r:e.row,c:e.column,b:t});return new a(this,i)}addRow(e,t=!1){const i=this.client.sendCommand("atr",{id:this.id,r:e.row,c:e.column,b:t});return new s(this,i)}deleteColumn(e){return this.client.sendCommand("dtc",{id:this.id,i:e})}deleteRow(e){return this.client.sendCommand("dtr",{id:this.id,i:e})}getCellByTextAreaKey(e){const t=e.match(/(\d+)/g);if(t&&2===t.length){const e=+t[0],i=+t[1];return new o(this,e,i)}}getRowCount(){return this.getRowHeights().length}getColumnCount(){return this.getColumnWidths().length}getRows(){return this.getRowHeights().map(((e,t)=>new s(this,t)))}getRowHeights(){return this.properties.get("RowHeights")}getColumnWidths(){return this.properties.get("ColWidths")}setColumnWidths(e){this.properties.set("ColWidths",e)}setRowHeights(e){this.properties.set("RowHeights",e)}getAutoResizeColumns(){return this.properties.get("AutoColWidth")}getAutoResizeRows(){return this.properties.get("AutoRowHeight")}setAutoResizeColumns(e){this.properties.set("AutoColWidth",e)}setAutoResizeRows(e){this.properties.set("AutoRowHeight",e)}setInsetMargin(e){this.properties.set("InsetMargin",e)}}t.TableBlockProxy=l,l.classNameRegex=/^DefaultTableBlock$/},290:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},6874:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BlockProxy=void 0;const n=i(4210),r=i(2969),o=i(8333),s=i(7713),a=i(8201),l=i(1836);class c extends l.ItemProxy{getClassName(){return this.properties.get("ClassName")}getRotation(){return this.properties.get("Rotation")}getRotatedBoundingBox(){return(0,a.rotatedBoundingBox)(this.getBoundingBox(),this.getRotation())}setRotation(e){this.properties.set("Rotation",e)}getShadow(){const e=this.properties.get("Shadow");if(e)return(0,s.deserializeShadow)(e)}setShadow(e){e?this.properties.set("Shadow",(0,s.serializeShadow)(e)):this.properties.set("Shadow",null)}setFillStyle(e){this.properties.set("FillColor",(0,o.serializeSimpleFill)(e))}getConnectedLines(){return this.client.sendCommand("gcl",this.id).map((e=>this.client.getLineProxy(e)))}setSimpleStaticDataGraphic(e){e?this.properties.set("StaticDataGraphic",(0,r.serializeSimpleStaticDataGraphicSettings)(e)):this.properties.set("StaticDataGraphic",void 0)}getSimpleStaticDataGraphic(){const e=this.properties.get("StaticDataGraphic");return(0,r.isSerializedSimpleStaticDataGraphicSettings)(e)?(0,r.deserializeSimpleStaticDataGraphicSettings)(e):void 0}lockAspectRatio(){const e=this.getBoundingBox();this.properties.set("AspectRatio",e.w/e.h)}unlockAspectRatio(){this.properties.set("AspectRatio",void 0)}getLineWidth(){return this.properties.get("LineWidth")}setLineWidth(e){this.properties.set("LineWidth",e)}linkText(e,t,i){if(!this.textAreas.keys().includes(e))throw new Error("Invalid text area key");if(!this.referenceKeys.keys().includes(t))throw new Error("Invalid reference key");this.properties.set(e+"_Link",{ref:t,f:i})}setDataSyncStateIconPosition(e){this.properties.set("DataSyncStateIconPosition",e?(0,n.serializeBadgeEnumPosition)(e):null)}}t.BlockProxy=c},3973:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CardConfigProxy=void 0;const n=i(7396);class r extends n.DocumentElementProxy{constructor(e,t){super(e,t),this.id=e}}t.CardConfigProxy=r},7396:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DocumentElementProxy=void 0;const n=i(5999);class r extends n.PropertyStoreProxy{constructor(e,t){super(e,t),this.id=e}}t.DocumentElementProxy=r},7442:(e,t)=>{var i;Object.defineProperty(t,"__esModule",{value:!0}),t.DocumentElementType=void 0,function(e){e.DataTransformation="DerivedStructure",e.Path="Path",e.Tag="Tag",e.CommentThreadMetadata="ThreadMetadata",e.FontStylePreset="FontStylePreset",e.IntraDocumentMutex="Mutex",e.Rule="Rule",e.DocumentFormula="Formula",e.TaskCardFieldsConfig="TaskCardFieldsConfig",e.GeneratorView="GeneratorView",e.ShapeStylePreset="ShapeStylePreset",e.ShapeSpecificDefaultProperties="ShapeSpecificDefaultProperties",e.TrackedFormulaLocation="TrackedFormulaLocation"}(i||(t.DocumentElementType=i={}))},4219:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.RuleProxy=t.RuleEffect=t.RuleCondition=void 0;const n=i(4210),r=i(4539),o=i(5990),s=i(7396);class a{constructor(e,t,i){this.rule=e,this.client=t,this.key=i,this.definition=this.rule.properties.get(this.key),this.type=this.definition.Type,this.condition=this.definition.Condition,this.value=this.definition.Value,this.field=this.definition.Label,this.fieldLabel=this.definition.DisplayLabel}update(e){this.rule.properties.set(this.key,(0,o.serializeConditionDefinition)(e)),this.definition=this.rule.properties.get(this.key)}}t.RuleCondition=a;class l{constructor(e,t,i){this.rule=e,this.client=t,this.key=i,this.definition=this.rule.properties.get(this.key),this.conditions=new r.MapProxy((()=>this.definition.ConditionOrder.map((e=>"Condition_"+e))),(e=>new a(this.rule,this.client,e))),this.combination=this.definition.Combination,this.formatType=this.definition.FormatType,this.formatting=this.definition.Formatting,this.dataGraphic=this.definition.DataGraphic&&{set:this.definition.DataGraphic.Set,index:this.definition.DataGraphic.Index,position:(0,n.deserializeBadgeEnumPosition)(this.definition.DataGraphic.Position),color:this.definition.DataGraphic.Color,image:this.definition.DataGraphic.Image&&{url:this.definition.DataGraphic.Image.url,w:this.definition.DataGraphic.Image.w,h:this.definition.DataGraphic.Image.h}}}update(e){let t=1;for(const e of this.rule.effects.values())t=Math.max(t,...e.definition.ConditionOrder.map((e=>e+1)));const i=this.definition.ConditionOrder;e.conditions.forEach(((e,n)=>{let r=i[n];void 0===r&&(r=t,i.push(t++));const s="Condition_"+r;this.rule.properties.set(s,(0,o.serializeConditionDefinition)(e))})),this.rule.properties.set(this.key,(0,o.serializeEffectDefinition)(e,i.slice(0,e.conditions.length)))}}t.RuleEffect=l;class c extends s.DocumentElementProxy{constructor(e,t){super(e,t),this.id=e,this.effects=new r.MapProxy((()=>this.properties.get("EffectOrder").map((e=>"Effect_"+e))),(e=>new l(this,this.client,e)))}getName(){return this.properties.get("Name")}setName(e){this.properties.set("Name",e)}getOrder(){return this.properties.get("Order")}delete(){this.client.sendCommand("dde",this.id)}static getRuleProperties(e){const t={EffectOrder:e.effects.map(((e,t)=>t+1)),SourceType:0,Name:e.name};let i=1,n=1;for(const r of e.effects){const e="Effect_"+n++,s=[];for(const e of r.conditions)s.push(i),t["Condition_"+i++]=(0,o.serializeConditionDefinition)(e);t[e]=(0,o.serializeEffectDefinition)(r,s)}return t}update(e){const t=c.getRuleProperties(e);for(const e in t)this.properties.set(e,t[e])}}t.RuleProxy=c},6290:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DocumentProxy=void 0;const n=i(3973),r=i(7442),o=i(4219),s=i(3385),a=i(1836),l=i(4539),c=i(9412);class d extends s.ElementProxy{static getNextHookName(){return"__documentproxy__hook"+d.nextHookId++}constructor(e){super(e.sendCommand("gdid",void 0),e),this.pages=new l.MapProxy((()=>this.client.sendCommand("lp",void 0)),(e=>new c.PageProxy(e,this.client))),this.cardIntegrationConfigs=new l.MapProxy((()=>this.client.sendCommand("lde",{t:r.DocumentElementType.TaskCardFieldsConfig})),(e=>new n.CardConfigProxy(e,this.client))),this.rules=new l.MapProxy((()=>this.client.sendCommand("lde",{t:r.DocumentElementType.Rule}).filter((e=>0===this.client.sendCommand("gp",{id:e,p:"SourceType"})))),(e=>new o.RuleProxy(e,this.client)))}*allBlocks(){for(const e of this.pages.values())for(const t of e.blocks.values())yield t}*allLines(){for(const e of this.pages.values())for(const t of e.lines.values())yield t}addPage(e){const t=this.client.sendCommand("cp",void 0),i=new c.PageProxy(t,this.client);return i.setTitle(e.title),i}setTitle(e){this.properties.set("Title",e)}getTitle(){return this.properties.get("Title")}getDocumentChunks(e){return this.client.sendCommand("gdc",{t:e}).map((e=>({boundingBox:e.bb,items:e.i.map((e=>this.client.getElementProxy(e))).filter((e=>e instanceof a.ItemProxy)),text:e.t,description:e.d})))}hookAllChanges(e){const t=d.getNextHookName();return this.client.registerAction(t,(()=>{e()})),this.client.sendCommand("hac",{n:t}),t}unhookAllChanges(e){this.client.deleteAction(e),this.client.sendCommand("uac",{n:e})}hookCreateItems(e){const t=d.getNextHookName();return this.client.registerAction(t,(t=>{e(t.ids.map((e=>this.client.getItemProxy(e))))})),this.client.sendCommand("hci",{n:t}),t}unhookCreateItems(e){this.client.deleteAction(e),this.client.sendCommand("uci",{n:e})}addRule(e){let t=0;for(const e of this.rules.values())t=Math.max(t,e.getOrder());const i=this.client.sendCommand("cde",{t:r.DocumentElementType.Rule,p:Object.assign(Object.assign({},o.RuleProxy.getRuleProperties(e)),{Order:t+1})});if(void 0!==i)return new o.RuleProxy(i,this.client)}hookDeleteItems(e){const t=d.getNextHookName();return this.client.registerAction(t,(t=>{e(t.ids)})),this.client.sendCommand("hdi",{n:t}),t}unhookDeleteItems(e){this.client.deleteAction(e),this.client.sendCommand("udi",{n:e})}async duplicateItems(e){return await this.client.sendCommand("dis",{ids:e})}}t.DocumentProxy=d,d.nextHookId=0},3385:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ElementProxy=void 0;const n=i(3931),r=i(7020),o=i(4539),s=i(5999),a=i(2418);class l extends s.PropertyStoreProxy{setReferenceKey(e,t){this.client.sendCommand("srk",{id:this.id,k:e,v:(0,n.serializeReferenceKeyDefinition)(t)})}removeReferenceKey(e){this.client.sendCommand("srk",{id:this.id,k:e})}constructor(e,t){super(e,t),this.shapeData=new a.ShapeDataProxy(this.id,this.client),this.allShapeData=new o.MapProxy((()=>this.client.sendCommand("lsd",{id:this.id,i:!0})),(e=>a.ShapeDataProxy.parseData(this.client.sendCommand("gsd",{id:this.id,n:e})))),this.referenceKeys=new o.MapProxy((()=>this.client.sendCommand("lrk",{id:this.id})),(e=>new r.ReferenceKeyProxy(this.id,e,this.client,this.client.sendCommand("grk",{id:this.id,k:e}))))}exists(){return this.client.sendCommand("ee",{id:this.id})}executeFormula(e){return a.ShapeDataProxy.parseData(this.client.sendCommand("ef",{id:this.id||"",f:e}))}}t.ElementProxy=l},7352:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GroupProxy=void 0;const n=i(1836),r=i(8719),o=i(4539);class s extends n.ItemProxy{constructor(){super(...arguments),this.blocks=new o.MapProxy((()=>this.client.sendCommand("lb",{id:this.id})),(e=>this.client.getBlockProxy(e))),this.lines=new o.MapProxy((()=>this.client.sendCommand("ll",{id:this.id})),(e=>new r.LineProxy(e,this.client))),this.groups=new o.MapProxy((()=>this.client.sendCommand("lg",{id:this.id})),(e=>new s(e,this.client))),this.allBlocks=new o.MapProxy((()=>this.client.sendCommand("lb",{id:this.id,d:!0})),(e=>this.client.getBlockProxy(e))),this.allLines=new o.MapProxy((()=>this.client.sendCommand("ll",{id:this.id,d:!0})),(e=>new r.LineProxy(e,this.client))),this.allGroups=new o.MapProxy((()=>this.client.sendCommand("lg",{id:this.id,d:!0})),(e=>new s(e,this.client)))}}t.GroupProxy=s},2141:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.imageToBlockDefinition=void 0,t.imageToBlockDefinition=function(e){return{className:"UserImage2Block",boundingBox:e.boundingBox,fillStyle:e.fillStyle,properties:{opactiy:e.opacity,lineColor:e.lineColor,lineWidth:e.lineWidth,strokeStyle:e.strokeStyle,rounding:e.rounding,rotation:e.rotation}}}},1836:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ItemProxy=void 0;const n=i(472),r=i(3385),o=i(4539);class s extends r.ElementProxy{constructor(e,t){super(e,t),this.id=e,this.textAreas=new o.WriteableMapProxy((()=>this.client.sendCommand("lta",this.id)),(e=>this.client.sendCommand("gp",{id:this.id,p:e})),((e,t,i)=>this.client.sendCommand("st",{id:this.id,n:e,t,f:null==i?void 0:i.force}))),this.textStyles=new o.WriteableMapProxy((()=>this.textAreas.keys()),(e=>this.client.sendCommand("gts",{id:this.id,n:e})),((e,t)=>this.client.sendCommand("sts",{id:this.id,n:e,s:t})))}getBoundingBox(){return this.properties.get("BoundingBox")}setBoundingBox(e){const t=this.getBoundingBox();t.x===e.x&&t.y===e.y||this.offset(n.OffsetType.MOVE,{x:e.x-t.x,y:e.y-t.y}),t.w===e.w&&t.h===e.h||this.offset(n.OffsetType.SE,{x:e.w-t.w,y:e.h-t.h})}getPageId(){return this.client.sendCommand("gip",this.id)}getPage(){return this.client.getPageProxy(this.getPageId())}getLocation(){const e=this.getBoundingBox();return{x:e.x,y:e.y}}setLocation(e){const t=this.getBoundingBox();t.x===e.x&&t.y===e.y||this.offset(n.OffsetType.MOVE,{x:e.x-t.x,y:e.y-t.y})}offset(e,t){this.client.sendCommand("oi",{ids:[this.id],t:e,o:t})}measureText(e,t){return this.client.sendCommand("mt",{id:this.id,n:e,w:t})}delete(){this.client.sendCommand("di",this.id)}getContainers(){return this.executeFormula("LABEL(CONTAINEDBY)").map((e=>this.client.getBlockProxy(e)))}changeZOrder(e){this.client.sendCommand("z",{i:[this.id],o:e})}applyRule(e){const t=this.properties.get("RuleList");t.includes(e.id)||(t.push(e.id),this.properties.set("RuleList",t))}unapplyRule(e){const t=this.properties.get("RuleList");t.includes(e.id)&&this.properties.set("RuleList",t.filter((t=>t!==e.id)))}}t.ItemProxy=s},2850:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isPositionEndpointDefinition=t.isLineEndpointDefinition=t.isBlockEndpointDefinition=void 0;const n=i(6930),r=i(7660),o=i(6874),s=i(8719);t.isBlockEndpointDefinition=function(e){return(0,r.objectValidator)({connection:(0,n.isInstanceOf)(o.BlockProxy),linkX:n.isNumber,linkY:n.isNumber,inside:(0,r.option)(n.isBoolean),autoLink:(0,r.option)(n.isBoolean),padding:(0,r.option)(n.isNumber)})(e)},t.isLineEndpointDefinition=function(e){return(0,r.objectValidator)({connection:(0,n.isInstanceOf)(s.LineProxy),position:n.isNumber})(e)},t.isPositionEndpointDefinition=function(e){return(0,r.objectValidator)({x:n.isNumber,y:n.isNumber})(e)}},8719:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LineProxy=t.LineShape=void 0;const n=i(6930),r=i(6874),o=i(1836),s=i(8056);var a;!function(e){e.Curve="curve",e.Elbow="elbow",e.Diagonal="diagonal"}(a||(t.LineShape=a={}));class l extends o.ItemProxy{getConnection(e){let t;if(e.Block&&(t=this.client.getBlockProxy(e.Block)),e.Line&&(t=this.client.getLineProxy(e.Line)),!t||t.exists())return t}isBlockEndpointDefinition(e){return e.connection instanceof r.BlockProxy}isLineEndpointDefinition(e){return e.connection instanceof l}parseLineEndpointDefinition(e){const t=this.getConnection(e);return t instanceof l?{connection:t,style:e.Style,position:e.Position,x:e.x,y:e.y}:t?{connection:t,style:e.Style,linkX:e.LinkX,linkY:e.LinkY,inside:e.Inside,autoLink:e.AutoLink,padding:e.Padding,x:e.x,y:e.y}:{style:e.Style,x:e.x,y:e.y}}serializeLineEndpointDefinition(e){if(this.isBlockEndpointDefinition(e)){const t=e.connection.getBoundingBox();return{Style:e.style,x:t.x+t.w*e.linkX,y:t.y+t.h*e.linkY,Block:e.connection.id,LinkX:e.linkX,LinkY:e.linkY,Inside:e.inside,AutoLink:e.autoLink,Padding:e.padding}}return this.isLineEndpointDefinition(e)?Object.assign({Style:e.style,Line:e.connection.id,LineP:e.position},e.connection.getRelativePosition(e.position)):{Style:e.style,x:e.x,y:e.y}}getEndpoint1(){return this.parseLineEndpointDefinition(this.properties.get("Endpoint1"))}getEndpoint2(){return this.parseLineEndpointDefinition(this.properties.get("Endpoint2"))}setEndpoint1(e){this.properties.set("Endpoint1",this.serializeLineEndpointDefinition(e))}setEndpoint2(e){this.properties.set("Endpoint2",this.serializeLineEndpointDefinition(e))}getUpstreamConnection(){return this.getEndpoint1().connection}getDownstreamConnection(){return this.getEndpoint2().connection}getConnectedLines(){return this.client.sendCommand("gcl",this.id).map((e=>this.client.getLineProxy(e)))}getRelativePosition(e){return this.client.sendCommand("grlp",{id:this.id,p:e})}getTextAreaPosition(e){const t=this.properties.get("TextAreas");if((0,n.isObjectUnsafe)(t)){const i=t[e];if((0,s.isSerializedLineTextAreaPositioning)(i))return(0,s.deserializeLineTextAreaPositioning)(i)}}setTextAreaPosition(e,t){this.properties.set("TextAreas",{[e]:(0,s.serializeLineTextAreaPositioning)(t)})}addTextArea(e,t){return this.client.sendCommand("alta",{id:this.id,p:(0,s.serializeLineTextAreaPositioning)(t),t:e})}deleteTextArea(e){this.properties.set("TextAreas",{[e]:null})}getShape(){return this.properties.get("Shape")}setShape(e){this.properties.set("Shape",e)}}t.LineProxy=l},8056:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.serializeLineTextAreaPositioning=t.deserializeLineTextAreaPositioning=t.isSerializedLineTextAreaPositioning=void 0;const n=i(6930);t.isSerializedLineTextAreaPositioning=function(e){return(0,n.isObjectUnsafe)(e)&&(0,n.isNumber)(e.Location)&&(0,n.isNumber)(e.Side)&&((0,n.isBoolean)(e.AllowOverBlock)||(0,n.isUndefined)(e.AllowOverBlock))},t.deserializeLineTextAreaPositioning=function(e){return{location:e.Location,side:e.Side,allowOverBlock:e.AllowOverBlock}},t.serializeLineTextAreaPositioning=function(e){return{Location:e.location,Side:e.side,AllowOverBlock:e.allowOverBlock}}},4539:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WriteableMapProxy=t.MapProxy=void 0;class i{constructor(e,t){this.getKeys=e,this.getItem=t}*[Symbol.iterator](){for(const e of this.keys()){const t=this.get(e);void 0!==t&&(yield[e,t])}}*values(){for(const e of this.keys()){const t=this.get(e);void 0!==t&&(yield t)}}find(e){for(const[t,i]of this)if(e(i,t))return i}filter(e){const t=[];for(const[i,n]of this)e(n,i)&&t.push(n);return t}map(e){const t=[];for(const[i,n]of this)t.push(e(n,i));return t}keys(){return this.getKeys()}get size(){return this.keys().length}get(e){return this.getItem(e)}first(){const e=this.keys();if(0!=e.length)return this.get(e[0])}}t.MapProxy=i,t.WriteableMapProxy=class extends i{constructor(e,t,i){super(e,t),this.setter=i}set(e,t,i={}){return this.setter(e,t,i)}}},7811:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},9412:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PageProxy=void 0;const n=i(3705),r=i(4219),o=i(3385),s=i(7352),a=i(2141),l=i(8719),c=i(4539);class d extends o.ElementProxy{constructor(e,t){super(e,t),this.id=e,this.blocks=new c.MapProxy((()=>this.client.sendCommand("lb",{id:this.id})),(e=>this.client.getBlockProxy(e))),this.lines=new c.MapProxy((()=>this.client.sendCommand("ll",{id:this.id})),(e=>new l.LineProxy(e,this.client))),this.groups=new c.MapProxy((()=>this.client.sendCommand("lg",{id:this.id})),(e=>new s.GroupProxy(e,this.client))),this.allBlocks=new c.MapProxy((()=>this.client.sendCommand("lb",{id:this.id,d:!0})),(e=>this.client.getBlockProxy(e))),this.allLines=new c.MapProxy((()=>this.client.sendCommand("ll",{id:this.id,d:!0})),(e=>new l.LineProxy(e,this.client))),this.allGroups=new c.MapProxy((()=>this.client.sendCommand("lg",{id:this.id,d:!0})),(e=>new s.GroupProxy(e,this.client))),this.allItems=new c.MapProxy((()=>[...this.allBlocks.keys(),...this.allLines.keys(),...this.allGroups.keys()]),(e=>this.client.getItemProxy(e)))}getRulesAppliedToAllItems(){return this.properties.get("ChildRuleList").map((e=>new r.RuleProxy(e,this.client)))}applyRuleToAllItems(e){const t=this.properties.get("ChildRuleList");t.includes(e.id)||(t.push(e.id),this.properties.set("ChildRuleList",t))}unapplyRuleToAllItems(e){const t=this.properties.get("ChildRuleList");t.includes(e.id)&&this.properties.set("ChildRuleList",t.filter((t=>t!==e.id)))}findAvailableSpace(e,t,i,n){const r=this.client.sendCommand("fas",{p:this.id,x:e,y:t,w:i,h:n});return{page:this,x:r.x,y:r.y}}addBlock(e){const t=this.client.sendCommand("cb",{p:this.id,c:e.className,s:e.stencil}),i=this.client.getBlockProxy(t);if(i.setBoundingBox(e.boundingBox),e.properties)for(const t in e.properties)i.properties.set(t,e.properties[t]);return void 0!==e.fillStyle&&i.setFillStyle(e.fillStyle),void 0!==e.lineWidth&&i.setLineWidth(e.lineWidth),i}groupBlocks(e){const t=this.client.sendCommand("cg",{p:this.id,i:e.map((e=>e.id))});return new s.GroupProxy(t,this.client)}addLine(e){const t=this.client.sendCommand("cl",{p:this.id}),i=new l.LineProxy(t,this.client);return i.setEndpoint1(e.endpoint1),i.setEndpoint2(e.endpoint2),i}async addImage(e){return await this.client.loadBlockClasses(["UserImage2Block"]),this.addBlock((0,a.imageToBlockDefinition)(e))}async addDiagramFromMermaid(e,t,i,n){return(await this.client.sendCommand("adfm",{t:e,m:t,o:i,e:n})).map((e=>this.client.getItemProxy(e)))}setTitle(e){this.properties.set("Title",e)}getTitle(){return this.properties.get("Title")}delete(){this.client.sendCommand("dp",this.id)}findItems(e,t){return this.client.sendCommand("gia",{p:this.id,bb:e,s:t}).map((e=>this.client.getItemProxy(e)))}async importLinks(e){return await this.client.sendCommand("il",{p:this.id,l:e})}getLLMContextForItems(e,t=n.GetLLMContextType.Relational){const i=this.client.sendCommand("llm",{p:this.id,i:e.map((e=>e.id)),t});return{prompt:i.p,idToLucidId:new Map(Object.entries(i.id))}}getSvg(e,t=!1,i){return this.client.sendCommand("gsvg",{p:this.id,bb:i,bg:t,i:null==e?void 0:e.map((e=>e.id))})}getPageNumber(){return this.properties.get("Order")}async duplicate(){await this.client.duplicatePages([this.getPageNumber()])}}t.PageProxy=d},5999:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PropertyStoreProxy=void 0;const n=i(4539);t.PropertyStoreProxy=class{constructor(e,t){this.id=e,this.client=t,this.properties=new n.WriteableMapProxy((()=>this.client.sendCommand("lpr",{id:this.id})),(e=>this.client.sendCommand("gp",{id:this.id,p:e})),((e,t)=>{if("BoundingBox"===e)throw new Error("Do not use properties.set() to move or resize items; use setLocation() or setBoundingBox() or offset()");this.client.sendCommand("sp",{id:this.id,p:e,v:t})}))}}},5990:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.serializeEffectDefinition=t.serializeConditionDefinition=void 0;const n=i(4210),r=i(1912),o=i(4718),s=i(8448);t.serializeConditionDefinition=function(e){switch(e.type){case o.ConditionType.Formula:return{Type:e.type,Source:"this",Condition:0,Value:e.formula};case o.ConditionType.Text:return{Type:e.type,Source:"this",Condition:e.condition,Value:e.value};case o.ConditionType.ShapeData:return{Type:e.type,Source:"this",Condition:e.condition,Value:e.value,Label:e.field,DisplayLabel:e.fieldLabel};case o.ConditionType.ShapeType:return{Type:e.type,Source:"this",Condition:e.condition,Value:e.classNames};default:throw new Error("Unsupported ConditionType")}},t.serializeEffectDefinition=function(e,t){var i;return{ConditionOrder:t,Combination:e.combination,FormatType:e.formatType,Formatting:e.formatType===s.RuleFormattingType.FORMATTING?{Block:{FillColor:JSON.stringify(e.formatting.fillColor),LineColor:JSON.stringify(e.formatting.borderColor),LineWidth:JSON.stringify(e.formatting.borderWidth),StrokeStyle:JSON.stringify(e.formatting.borderStyle)},Line:{LineColor:JSON.stringify(e.formatting.lineColor),LineWidth:JSON.stringify(e.formatting.lineWidth),StrokeStyle:JSON.stringify(e.formatting.lineStyle)}}:{},DataGraphic:e.formatType===s.RuleFormattingType.DATA_GRAPHICS?e.dataGraphic.set===r.DataGraphicIconSets.CUSTOM_ICONS?{Set:e.dataGraphic.set,Index:0,Position:(0,n.serializeBadgeEnumPosition)(e.dataGraphic.position),Image:{url:e.dataGraphic.image.url,w:e.dataGraphic.image.width,h:e.dataGraphic.image.height}}:{Set:e.dataGraphic.set,Index:null!==(i=e.dataGraphic.index)&&void 0!==i?i:0,Position:(0,n.serializeBadgeEnumPosition)(e.dataGraphic.position),Color:e.dataGraphic.color}:void 0,Tooltip:e.tooltip}}},2418:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ShapeDataProxy=void 0;const n=i(6930),r=i(3191),o=i(816),s=i(1266),a=i(4539);class l extends a.WriteableMapProxy{constructor(e,t){super((()=>this.client.sendCommand("lsd",{id:this.id})),(e=>l.parseData(this.client.sendCommand("gsd",{id:this.id,n:e}))),((e,t)=>{if((0,r.isSerializedDataError)(t))throw new Error("Cannot store an error value");this.keys().includes(e)?this.client.sendCommand("ssd",{id:this.id,n:e,v:t}):this.client.sendCommand("asd",{id:this.id,i:o.ShapeDataInheritance.NONE,n:e,v:t})})),this.id=e,this.client=t}addInheritable(e,t){this.client.sendCommand("asd",{id:this.id,i:o.ShapeDataInheritance.VALUE,n:e,v:t})}delete(e){this.keys().includes(e)&&this.client.sendCommand("dsd",{id:this.id,n:e})}static parseData(e){return(0,r.isSerializedDataError)(e)?new s.DataError(e.error,e.type):e}getString(e){const t=this.get(e);return(0,n.isString)(t)?t:""}}t.ShapeDataProxy=l},9285:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isPartialTextStyle=t.TextMarkupNames=void 0;const n=i(6930),r=i(7660);var o;!function(e){e.Family="font",e.Bold="bold",e.Italic="italic",e.Underline="underline",e.Size="size",e.Color="color",e.HAlign="align"}(o||(t.TextMarkupNames=o={})),t.isPartialTextStyle=(0,r.partialObjectValidator)({[o.Family]:n.isString,[o.Bold]:n.isBoolean,[o.Italic]:n.isBoolean,[o.Underline]:n.isBoolean,[o.Size]:n.isNumber,[o.Color]:n.isString,[o.HAlign]:n.isString})},2501:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EditorClient=void 0;const n=i(3705),r=i(9148),o=i(6930),s=i(1430),a=i(3893),l=i(1468),c=i(4593),d=i(9721),u=i(6202),h=i(6874),p=i(6290),m=i(3385),y=i(7352),f=i(8719),g=i(9412),S=i(8404);function C(e,t){var i,n,o,s;return Object.assign({url:null!==(i=null==t?void 0:t.url)&&void 0!==i?i:"",status:null!==(n=null==t?void 0:t.s)&&void 0!==n?n:0,headers:null!==(o=null==t?void 0:t.h)&&void 0!==o?o:{},timeout:null==t?void 0:t.to},"utf8"===e?{responseFormat:e,responseText:null!==(s=null==t?void 0:t.t)&&void 0!==s?s:"An unknown error occurred"}:{responseFormat:e,responseData:(null==t?void 0:t.t)?(0,r.decodeBase64)(t.t):new Uint8Array(0)})}t.EditorClient=class{getUniqueActionName(){for(;this.actionExists("a"+this.nextId);)this.nextId++;return"a"+this.nextId}getProduct(){return this.sendCommand("gpr",void 0)}killExtension(){this.sendCommand("k",void 0)}reloadExtension(){this.sendCommand("r",void 0)}download(e,t,i,n){this.sendCommand("d",{f:e,d:t,m:i,b64:n})}async createUserImage(e,t){return(await this.sendCommand("cui",{t:e,d:(0,o.isString)(t)?t:(0,r.encodeBase64)(t)})).u}experimentalCreateUserImage(e,t){return this.createUserImage(e,t)}async performDataAction(e){void 0===e.asynchronous&&(e.asynchronous=!0);const t=await this.sendCommand("da",{fn:e.actionName,a:e.asynchronous,s:e.syncDataSourceIdNonce,fd:e.actionData,n:e.dataConnectorName});return"t"in t?{status:t.c,text:t.t}:{status:t.c,json:t.j}}async showPackageSettingsModal(){return this.sendCommand("spsm",void 0)}async setPackageSettings(e){let t={};if(e instanceof Map)for(const[i,n]of e.entries())t[i]=n;else t=e;return this.sendCommand("sps",t)}async getPackageSettings(){return new Map(Object.entries(await this.sendCommand("gps",void 0)))}async canEditPackageSettings(){return this.sendCommand("ceps",void 0)}async awaitDataImport(e,t,i,n,r=3e4){return new l.CollectionProxy(await this.sendCommand("ai",{n:e,s:t,c:i,pk:n,t:r}),this)}async awaitDataSourceImport(e,t){return await this.sendCommand("adi",{n:e,s:t})}xhr(e){let t;e.streamCallback&&(t=this.getUniqueActionName(),this.registerAction(t,(t=>{var i;return null===(i=e.streamCallback)||void 0===i?void 0:i.call(e,t.d)})));const i=e.responseFormat||"utf8";return this.sendCommand("xhr",{url:e.url,m:e.method,d:e.data,h:e.headers,ms:e.timeoutMs,f:i,s:t}).then((e=>C(i,e))).catch((e=>{const t=(0,n.isRawSendXHRResponse)(e)?e:void 0;throw C(i,t)})).finally((()=>{t&&this.deleteAction(t)}))}asyncOAuthXhr(e,t){const i=t.responseFormat||"utf8";return this.sendCommand("aoauth",Object.assign({url:t.url,m:t.method,d:t.data,h:t.headers,ms:t.timeoutMs,p:e,f:i},t.postResultTo?{prt:t.postResultTo}:{})).then((e=>C(i,e))).catch((e=>{const t=(0,n.isRawSendXHRResponse)(e)?e:void 0;throw C(i,t)}))}oauthXhr(e,t){const i=t.responseFormat||"utf8";return this.sendCommand("oauth",Object.assign({url:t.url,m:t.method,d:t.data,h:t.headers,ms:t.timeoutMs,p:e,f:i},t.postResultTo?{prt:t.postResultTo}:{})).then((e=>C(i,e))).catch((e=>{const t=(0,n.isRawSendXHRResponse)(e)?e:void 0;throw C(i,t)}))}triggerAuthFlow(e){return this.sendCommand("tauth",{p:e})}async getOAuthToken(e){return await this.sendCommand("got",{p:e})}async getOAuthClientId(e){return await this.sendCommand("goci",{p:e})}permanentTokenXhr(e,t){const i=t.responseFormat||"utf8";return this.sendCommand("perm",{url:t.url,m:t.method,d:t.data,h:t.headers,ms:t.timeoutMs,p:e,f:i}).then((e=>C(i,e))).catch((e=>{const t=(0,n.isRawSendXHRResponse)(e)?e:void 0;throw C(i,t)}))}registerAction(e,t){if(this.actionExists(e))throw new Error("Action already exists: "+e);this.callbacks.set(e,t)}registerFileUploadAction(e,t){this.registerAction(e,(e=>{t(e.f.map((e=>e.b?{fileName:e.n,text:e.t,binary:(0,r.decodeBase64)(e.b)}:{fileName:e.n,text:e.t})))}))}registerUnfurlHandler(e,t){const i=this.getUniqueActionName();let n,r;this.registerAction(i,(async e=>{const i=(0,S.deserializeUnfurlEventMessage)(e);try{const e=await t.unfurlCallback(i.url);if(e&&!(0,a.unfurlRefreshErrorTypeValidator)(e))return(0,s.serializeUnfurlDetails)(e)}catch(e){return a.UnfurlRefreshErrorType.GenericFailure}})),t.afterUnfurlCallback&&(n=this.getUniqueActionName(),this.registerAction(n,(async e=>{var i;const n=(0,S.deserializeUnfurlEventMessage)(e);if(n.blockId){const e=this.getBlockProxy(n.blockId);e instanceof u.LinkUnfurlBlockProxy&&await(null===(i=t.afterUnfurlCallback)||void 0===i?void 0:i.call(t,e,n.url))}}))),t.expandCallback&&(r=this.getUniqueActionName(),this.registerAction(r,(async e=>{var i;const n=(0,S.deserializeUnfurlEventMessage)(e);if(n.blockId){const e=this.getBlockProxy(n.blockId);e instanceof u.LinkUnfurlBlockProxy&&await(null===(i=t.expandCallback)||void 0===i?void 0:i.call(t,e,n.url))}}))),this.sendCommand("ru",{d:e,ua:i,aua:n,e:r})}experimentalRegisterUnfurlHandler(e,t){return this.registerUnfurlHandler(e,t)}deleteAction(e){this.callbacks.delete(e)}actionExists(e){return this.callbacks.has(e)}sendCommand(e,t){return lucid.executeCommand(e,t)}getBlockProxy(e){const t=this.sendCommand("gp",{id:e,p:"ClassName"});let i=(0,c.findProxyClass)(t);return i===d.CustomBlockProxy&&(i=d.CustomBlockProxy.getCustomBlockClass(this,e)),i?new i(e,this):new h.BlockProxy(e,this)}loadBlockClasses(e){return this.sendCommand("lbc",e)}async importPage(e,t){return await this.sendCommand("imp",{id:e,n:t})}async duplicatePages(e){return await this.sendCommand("imp",{id:this.sendCommand("gdid",void 0),n:e})}async getCustomShapeDefinition(e,t){await this.loadBlockClasses(["CustomBlock"]);const i=await this.sendCommand("gcs",{l:e,s:t});if(i)return{className:"CustomBlock",boundingBox:i.bb,stencil:i.s,properties:i.p}}async processAndClearBootstrapData(e,t){const i=this.getUniqueActionName();this.registerAction(i,(t=>e(t.d))),await this.sendCommand("b",{c:i,m:t}),this.deleteAction(i)}getLineProxy(e){return new f.LineProxy(e,this)}getPageProxy(e){return new g.PageProxy(e,this)}getItemProxy(e){const t=this.sendCommand("get",{id:e});switch(t){case"block":return this.getBlockProxy(e);case"line":return this.getLineProxy(e);case"group":return new y.GroupProxy(e,this);default:throw new Error("Element "+e+" is not an Item; type found is "+t)}}tryGetItemProxy(e){try{const t=this.getItemProxy(e);if(t.exists())return t}catch(e){}}getElementProxy(e){switch(this.sendCommand("get",{id:e})){case"block":return this.getBlockProxy(e);case"line":return this.getLineProxy(e);case"page":return this.getPageProxy(e);case"document":return new p.DocumentProxy(this);case"group":return new y.GroupProxy(e,this);default:return new m.ElementProxy(e,this)}}listenToEditor(){lucid.listen((e=>{var t;return null===(t=this.callbacks.get(e.id))||void 0===t?void 0:t(e)}))}alert(e,t,i){return this.sendCommand("a",{t,b:e,bt:i})}confirm(e,t,i,n){return this.sendCommand("c",{t,b:e,o:i,c:n})}prompt(e,t){return this.sendCommand("p",{t,b:e})}async withIntraDocumentMutex(e,t){const i=this.getUniqueActionName();this.registerAction(i,t);try{return await this.sendCommand("wm",{n:e,a:i})}finally{this.deleteAction(i)}}withSilentActions(e){const t=this.getUniqueActionName();this.registerAction(t,(()=>{const t=e();if((0,o.isPromise)(t))throw new Error("withSilentActions cannot be used with an async callback")}));try{this.sendCommand("wsa",{a:t})}finally{this.deleteAction(t)}}hash(e,t){return this.sendCommand("hsh",{a:e,s:t})}constructor(){this.nextId=0,this.callbacks=new Map,this.listenToEditor()}}},7171:function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var r=Object.getOwnPropertyDescriptor(t,i);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,r)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),r=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||n(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),r(i(3705),t),r(i(9148),t),r(i(2203),t),r(i(7702),t),r(i(6096),t),r(i(4761),t),r(i(4710),t),r(i(6930),t),r(i(639),t),r(i(1270),t),r(i(2546),t),r(i(6732),t),r(i(9309),t),r(i(4827),t),r(i(7457),t),r(i(4945),t),r(i(9002),t),r(i(5463),t),r(i(1116),t),r(i(1069),t),r(i(4925),t),r(i(2939),t),r(i(3581),t),r(i(6730),t),r(i(6798),t),r(i(5070),t),r(i(6326),t),r(i(5271),t),r(i(9098),t),r(i(1346),t),r(i(4196),t),r(i(97),t),r(i(1690),t),r(i(8326),t),r(i(7909),t),r(i(6390),t),r(i(1251),t),r(i(1292),t),r(i(472),t),r(i(9720),t),r(i(4210),t),r(i(1912),t),r(i(2969),t),r(i(8333),t),r(i(7713),t),r(i(2188),t),r(i(9341),t),r(i(4718),t),r(i(8448),t),r(i(3191),t),r(i(816),t),r(i(8137),t),r(i(6982),t),r(i(5996),t),r(i(1430),t),r(i(3578),t),r(i(3893),t),r(i(3436),t),r(i(7660),t),r(i(2409),t),r(i(3659),t),r(i(1468),t),r(i(1266),t),r(i(6237),t),r(i(4256),t),r(i(7807),t),r(i(9697),t),r(i(3931),t),r(i(7020),t),r(i(7700),t),r(i(685),t),r(i(932),t),r(i(306),t),r(i(8310),t),r(i(4444),t),r(i(8399),t),r(i(53),t),r(i(2502),t),r(i(6298),t),r(i(851),t),r(i(4593),t),r(i(4936),t),r(i(9721),t),r(i(4607),t),r(i(1895),t),r(i(6202),t),r(i(6404),t),r(i(9642),t),r(i(290),t),r(i(6874),t),r(i(6290),t),r(i(3385),t),r(i(7352),t),r(i(1836),t),r(i(2850),t),r(i(8719),t),r(i(8056),t),r(i(4539),t),r(i(7811),t),r(i(9412),t),r(i(5999),t),r(i(2418),t),r(i(9285),t),r(i(2501),t),r(i(7171),t),r(i(8201),t),r(i(8404),t),r(i(8627),t),r(i(6106),t),r(i(2303),t),r(i(7999),t),r(i(8260),t),r(i(2382),t),r(i(2362),t)},8201:(e,t)=>{function i(e,t){const i=Math.max(e.x,t.x),n=Math.max(e.y,t.y);return{x:i,y:n,w:Math.min(e.x+e.w,t.x+t.w)-i,h:Math.min(e.y+e.h,t.y+t.h)-n}}function n(e){return{x:e.x+e.w/2,y:e.y+e.h/2}}function r(e,t,i){const r=s(e);return i=i||n(e),0!=t?r.map(a(i,t)):r}function o(e,t,i,n){const r=Math.min(e.x,t.x,i.x,n.x),o=Math.max(e.x,t.x,i.x,n.x),s=Math.min(e.y,t.y,i.y,n.y);return{x:r,y:s,w:o-r,h:Math.max(e.y,t.y,i.y,n.y)-s}}function s(e){return[{x:e.x,y:e.y},{x:e.x+e.w,y:e.y},{x:e.x+e.w,y:e.y+e.h},{x:e.x,y:e.y+e.h}]}function a(e,t){const i=Math.cos(t),n=Math.sin(t);return t=>{const r=e.x,o=e.y,s=t.x-r,a=t.y-o;return{x:s*i-a*n+r,y:a*i+s*n+o}}}Object.defineProperty(t,"__esModule",{value:!0}),t.rotateAroundFn=t.toCornersAsArray=t.boxFrom4Points=t.rotateBox=t.rotatedBoundingBox=t.boxCenter=t.clip=t.percentBoxesOverlap=t.boxesOverlap=t.isBoxWithin=t.padBox=t.combinedBoundingBox=void 0,t.combinedBoundingBox=function(e){if(0==e.length)return;let t=Number.MAX_VALUE,i=Number.MAX_VALUE,n=-Number.MAX_VALUE,r=-Number.MAX_VALUE;for(const o of e)t=Math.min(t,o.x),n=Math.max(n,o.x+o.w),i=Math.min(i,o.y),r=Math.max(r,o.y+o.h);return{x:t,y:i,w:n-t,h:r-i}},t.padBox=function(e,t){return{x:e.x-t,y:e.y-t,w:e.w+2*t,h:e.h+2*t}},t.isBoxWithin=function(e,t){return e.x>=t.x&&e.y>=t.y&&e.x+e.w<=t.x+t.w&&e.y+e.h<=t.y+t.h},t.boxesOverlap=function(e,t){return e.x+e.w>=t.x&&e.y+e.h>=t.y&&t.x+t.w>=e.x&&t.y+t.h>=e.y},t.percentBoxesOverlap=function(e,t){const n=i(e,t);return n.w<=0||n.h<=0?0:n.w*n.h/(e.w*e.h)},t.clip=i,t.boxCenter=n,t.rotatedBoundingBox=function(e,t,i){return t?(i=i||n(e),o.apply(null,r(e,t,i))):e},t.rotateBox=r,t.boxFrom4Points=o,t.toCornersAsArray=s,t.rotateAroundFn=a},8404:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.serializeUnfurlEventMessage=t.deserializeUnfurlEventMessage=void 0,t.deserializeUnfurlEventMessage=function(e){return{id:e.id,url:e.u,unfurlCallbackType:e.t,blockId:e.b}},t.serializeUnfurlEventMessage=function(e){return{id:e.id,u:e.url,t:e.unfurlCallbackType,b:e.blockId}}},8627:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AlertModal=void 0;const n=i(7999);class r extends n.Modal{constructor(e,t,i){super(e,{width:300,height:200,title:t,content:`\n<html>\n<head>\n<style type="text/css">\np {\n    font-family: 'Graphik LC Web', sans-serif;\n    font-size:14px;\n    text-align:center;\n}\n</style>\n</head>\n<body>\n<p id="message"></p>\n<script type="text/javascript">\n    var p = document.getElementById('message');\n    p.innerText = ${JSON.stringify(i)};\n<\/script>\n</body>\n</html>\n            `})}}t.AlertModal=r},6106:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.IframeUI=t.IncomingUIMessageType=void 0;const n=i(2555);var r;!function(e){e[e.Closed=1]="Closed",e[e.PostMessageFromFrame=2]="PostMessageFromFrame",e[e.FrameLoaded=3]="FrameLoaded",e[e.FramePosition=4]="FramePosition"}(r||(t.IncomingUIMessageType=r={}));class o{constructor(e){this.client=e,this.id=++o.nextId,this.messageActionName=o.uiMessageActionNamePrefix+this.id,this.loaded=!1,this.frameLoadedPromise=(0,n.defer)(),this.framePosition={x:0,y:0,w:1,h:1}}static isUIMessageActionName(e){return e.startsWith(o.uiMessageActionNamePrefix)}hookMessages(){this.client.registerAction(this.messageActionName,(e=>{switch(e.t){case r.Closed:this.loaded=!1,this.frameClosed();break;case r.PostMessageFromFrame:this.messageFromFrame(e.data);break;case r.FramePosition:this.framePosition=e.data;break;case r.FrameLoaded:this.loaded=!0,this.frameLoadedPromise.resolve(),this.frameLoaded()}}))}unhookMessages(){this.client.deleteAction(this.messageActionName)}async sendMessage(e){await this.frameLoadedPromise,this.client.sendCommand("suim",{n:this.messageActionName,d:e})}messageFromFrame(e){}frameLoaded(){}frameClosed(){}}t.IframeUI=o,o.nextId=0,o.uiMessageActionNamePrefix="__ui_message__"},2303:(e,t)=>{var i,n;Object.defineProperty(t,"__esModule",{value:!0}),t.Menu=t.MenuLocation=t.MenuType=void 0,function(e){e[e.Main=1]="Main",e[e.Context=2]="Context",e[e.ContentDock=3]="ContentDock"}(i||(t.MenuType=i={})),function(e){e[e.Extension=1]="Extension",e[e.Edit=2]="Edit",e[e.View=3]="View",e[e.Share=4]="Share",e[e.Export=5]="Export",e[e.Import=6]="Import"}(n||(t.MenuLocation=n={})),t.Menu=class{constructor(e){this.client=e}addMenuItem(e){if(e.action&&!this.client.actionExists(e.action))throw new Error("Unregistered action: "+e.action);if(e.visibleAction&&!this.client.actionExists(e.visibleAction))throw new Error("Unregistered action: "+e.visibleAction);if(e.disabledAction&&!this.client.actionExists(e.disabledAction))throw new Error("Unregistered action: "+e.disabledAction);if(e.menuType==i.ContentDock&&!e.iconUrl)throw new Error("MenuType.ContentDock requires icon url");if(e.menuType==i.ContentDock&&!e.action)throw new Error("MenuType.ContentDock requires action");this.client.sendCommand("ami",{l:e.label,i:e.iconUrl,a:e.action,v:e.visibleAction,d:e.disabledAction,t:e.menuType,loc:e.location,f:e.file?{a:e.file.action,ac:e.file.accept,s:e.file.singleFileOnly,b:e.file.binary}:void 0})}addDropdownMenuItem(e){var t;this.addMenuItem({label:e.label,action:e.action,visibleAction:e.visibleAction,disabledAction:e.disabledAction,menuType:i.Main,location:null!==(t=e.location)&&void 0!==t?t:n.Extension,file:e.file})}addContextMenuItem(e){this.addMenuItem({label:e.label,action:e.action,visibleAction:e.visibleAction,disabledAction:e.disabledAction,menuType:i.Context,location:n.Extension,file:e.file})}addContentDockMenuItem(e){this.addMenuItem({label:e.label,iconUrl:e.iconUrl,action:e.action,visibleAction:e.visibleAction,disabledAction:e.disabledAction,menuType:i.ContentDock,location:n.Extension,file:e.file})}}},7999:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Modal=void 0;const n=i(6106);class r extends n.IframeUI{constructor(e,t){super(e),this.config=t,this.visible=!1}frameClosed(){this.visible=!1,this.unhookMessages()}async show(){this.visible||(this.hookMessages(),await this.client.sendCommand("sm",{n:this.messageActionName,t:this.config.title,w:this.config.width,h:this.config.height,cl:this.config.chromeless,fs:this.config.fullScreen,tb:this.config.transparentBackground,c:this.config.content,u:this.config.url}),this.visible=!0)}hide(){this.visible&&(this.client.sendCommand("hm",{n:this.messageActionName}),this.visible=!1)}}t.Modal=r},8260:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Panel=t.PanelLocation=void 0;const n=i(6106);var r;!function(e){e[e.RightDock=1]="RightDock",e[e.ContentDock=2]="ContentDock",e[e.ImageSearchTab=3]="ImageSearchTab"}(r||(t.PanelLocation=r={}));class o extends n.IframeUI{constructor(e,t){super(e),this.config=t,this.hookMessages(),this.client.sendCommand("rp",{n:this.messageActionName,t:this.config.title,l:this.config.location,c:this.config.content,u:this.config.url,v:this.config.visibleAction,i:this.config.iconUrl,to:this.config.toolTip,p:this.config.persist,w:this.config.width,h:this.config.height})}show(){this.config.location==r.RightDock&&this.client.sendCommand("spn",{n:this.messageActionName})}hide(){this.config.location==r.RightDock&&this.client.sendCommand("hp",{n:this.messageActionName})}}t.Panel=o},2382:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Viewport=void 0;const n=i(6930),r=i(8333),o=i(2141),s=i(1836),a=i(9412),l=i(8201);class c{constructor(e){this.client=e}static nextHookName(){return"__viewport__hook"+c.nextHookId++}getSelectedItems(e){return this.client.sendCommand("gs",{d:e}).map((e=>this.client.getElementProxy(e))).filter((e=>e instanceof s.ItemProxy))}setSelectedItems(e){this.client.sendCommand("ss",{i:e.map((e=>e.id))})}findAvailableSpace(e,t){const i=this.client.sendCommand("fas",{w:e,h:t});return{page:new a.PageProxy(i.p,this.client),x:i.x,y:i.y}}getCurrentPage(){const e=this.client.sendCommand("gcp",void 0);return null==e?e:new a.PageProxy(e,this.client)}setCurrentPage(e){this.client.sendCommand("scp",e.id)}getVisibleRect(){return this.client.sendCommand("gvr",void 0)}focusCameraOnItems(e){const t=(0,l.combinedBoundingBox)(e.map((e=>e.getBoundingBox())));t&&e[0]&&this.client.sendCommand("av",{bb:(0,l.padBox)(t,80),p:e[0].getPage().id})}hookTextEdit(e,t){const i=c.nextHookName();return this.client.registerAction(i,(async t=>{const i=this.client.getElementProxy(t.i);if(i instanceof s.ItemProxy){const r=await e(i,t.t,t.v);if((0,n.isBoolean)(r))return r;{const e=c.nextHookName();return this.client.registerAction(e,(t=>(this.client.deleteAction(e),r(t.v)))),e}}return!0})),this.client.sendCommand("hte",{n:i,e:!!t}),i}unhookTextEdit(e){this.client.deleteAction(e),this.client.sendCommand("ute",{n:e})}hookSelection(e){const t=c.nextHookName();return this.client.registerAction(t,(async t=>{const i=t.ids.map((e=>this.client.getElementProxy(e))).filter((e=>e instanceof s.ItemProxy));e(i)})),this.client.sendCommand("hs",{n:t}),t}unhookSelection(e){this.client.deleteAction(e),this.client.sendCommand("us",{n:e})}async startDraggingNewBlock(e){var t;const i=null!==(t=e.properties)&&void 0!==t?t:{};void 0!==e.fillStyle&&(i.FillColor=(0,r.serializeSimpleFill)(e.fillStyle)),void 0!==e.lineWidth&&(i.LineWidth=e.lineWidth);const n=await this.client.sendCommand("sdc",{c:e.className,sz:{w:e.boundingBox.w,h:e.boundingBox.h},p:i,s:e.stencil});return n?this.client.getBlockProxy(n):void 0}async startDraggingNewImage(e){return await this.client.loadBlockClasses(["UserImage2Block"]),await this.startDraggingNewBlock((0,o.imageToBlockDefinition)(e))}cancelDraggingNewBlock(){this.client.sendCommand("cdc",void 0)}cancelDraggingNewImage(){this.cancelDraggingNewBlock()}dragPointerMove(e,t){this.client.sendCommand("dpm",{x:e,y:t})}dragPointerUp(e,t){this.client.sendCommand("dpu",{x:e,y:t})}}t.Viewport=c,c.nextHookId=0},2362:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.UserProxy=void 0,t.UserProxy=class{constructor(e){this.client=e,this.id=this.client.sendCommand("guid",void 0)}getAccessPermssionOnDocument(){return this.client.sendCommand("gdap",void 0)}}}},t={};function i(n){var r=t[n];if(void 0!==r)return r.exports;var o=t[n]={exports:{}};return e[n].call(o.exports,o,o.exports,i),o.exports}(()=>{const e=i(7171),t=new e.EditorClient,n=(new e.Menu(t),new e.Viewport(t)),r=new e.DocumentProxy(t);let o=[""];class s extends e.Modal{constructor(e){super(e,{title:"Custom Bracket",width:700,height:500,url:"customModal.html"})}messageFromFrame(e){const i=JSON.stringify(e);o=function(e){try{const t=JSON.parse(e);if(Array.isArray(t.messageArray))return t.messageArray;throw new Error("The key 'messageArray' is not an array.")}catch(e){return console.error("Failed to parse JSON string:",e),[]}}(i),"m"===JSON.stringify(e)[2]?(this.hide(),async function(){const e=o;console.log(e);const i=[];128==e.length&&(i.push(e[0],e[1],e[126],e[127],e[62],e[63],e[64],e[65],e[30],e[31],e[96],e[97],e[32],e[33],e[94],e[95],e[14],e[15],e[112],e[113],e[48],e[49],e[78],e[79],e[16],e[17],e[110],e[111],e[46],e[47],e[80],e[81],e[6],e[7],e[120],e[121],e[56],e[57],e[70],e[71],e[24],e[25],e[102],e[103],e[38],e[39],e[88],e[89],e[8],e[9],e[118],e[119],e[54],e[55],e[72],e[73],e[22],e[23],e[104],e[105],e[40],e[41],e[86],e[87],e[2],e[3],e[124],e[125],e[60],e[61],e[66],e[67],e[28],e[29],e[98],e[99],e[34],e[35],e[92],e[93],e[12],e[13],e[114],e[115],e[50],e[51],e[76],e[77],e[18],e[19],e[108],e[109],e[44],e[45],e[82],e[83],e[4],e[5],e[122],e[123],e[58],e[59],e[68],e[69],e[26],e[27],e[100],e[101],e[36],e[37],e[90],e[91],e[10],e[11],e[58],e[59],e[52],e[53],e[74],e[75],e[10],e[21],e[106],e[107],e[42],e[43],e[84],e[85]),console.log("size 64")),64==e.length&&(i.push(e[0],e[1],e[62],e[63],e[30],e[31],e[32],e[33],e[16],e[17],e[46],e[47],e[14],e[15],e[48],e[49],e[6],e[7],e[56],e[57],e[24],e[25],e[38],e[39],e[22],e[23],e[40],e[41],e[8],e[9],e[54],e[55],e[2],e[3],e[60],e[61],e[28],e[29],e[34],e[35],e[18],e[19],e[44],e[45],e[12],e[13],e[50],e[51],e[4],e[5],e[58],e[59],e[26],e[27],e[36],e[37],e[20],e[21],e[42],e[43],e[10],e[11],e[52],e[53]),console.log("size 32")),32==e.length&&(i.push(e[0],e[1],e[30],e[31],e[14],e[15],e[16],e[17],e[8],e[9],e[22],e[23],e[6],e[7],e[24],e[25],e[10],e[11],e[20],e[21],e[4],e[5],e[26],e[27],e[12],e[13],e[18],e[19],e[2],e[3],e[28],e[29]),console.log("size 16")),16==e.length&&(i.push(e[0],e[1],e[14],e[15],e[6],e[7],e[8],e[9],e[4],e[5],e[10],e[11],e[2],e[3],e[12],e[13]),console.log("size 8")),8==e.length&&(i.push(e[0],e[1],e[6],e[7],e[2],e[3],e[4],e[5]),console.log("size 4")),4==e.length&&(i.push(e[0],e[1],e[2],e[3]),console.log("size 2"));let s=0,l=i.length/2,c=Math.log2(l);const d=r.addPage({title:"Bracket"});n.setCurrentPage(d);const{x:u,y:h}=n.getVisibleRect();let p,m,y;switch(l){case 64:p=[0,90,200,480,940,2010,980],m=[0,400,800,1200,1600,2e3,2500],y=[110,300,680,1435,2980,1e3];break;case 32:p=[0,90,200,480,940,525],m=[0,400,800,1200,1600,2e3],y=[110,300,680,1435,1e3];break;case 16:p=[0,90,200,480,250],m=[0,400,800,1200,1600],y=[110,300,680,1e3];break;case 8:p=[0,90,200,140],m=[0,400,800,1200],y=[110,300,680,1e3];break;case 4:p=[0,90,45],m=[0,400,800],y=[110,300,680];break;case 2:p=[0,45],m=[0,400],y=[110];break;default:p=[],m=[],y=[]}const f=await t.getCustomShapeDefinition("test","first");let g;if(g=[],f&&console.log("custom shape loaded"),f){for(let S=0;S<c+1;S++){let C=m[S];for(let T=1;T<=l/2**S;T++){const b=0===S?`${i[2*(T-1)]} - ${i[2*(T-1)+1]}`:"TBD";f.boundingBox.x=u+C,f.boundingBox.y=h+s+p[S];const v=d.addBlock(f),P=v.textAreas.keys()[0];v.textAreas.set(P,b),g.push(v),s+=T%2==0?y[S]:80}s=p[S]}{function x(){let e=0,t=g.length,i=l;for(;e+i<=t;){let n=e+i,r=i/2;for(let r=0;r<i;r+=2)e+r+1<n&&n+r/2<t&&a(g[e+r+1],g[n+r/2]);e=n,i=r}}x()}}else console.log("custom shape not loaded")}()):"c"==JSON.stringify(e)[2]&&(this.hide(),console.log("cancel"))}}function a(e,t){e.getPage().addLine({endpoint1:{connection:e,linkX:1,linkY:0},endpoint2:{connection:t,linkX:0,linkY:.5}})}t.registerAction("custom-bracket",(async()=>{!async function(){new s(t).show()}()})),t.registerFileUploadAction("create-bracket",(async e=>{!async function(e){let i="";for(const h of e)i+=h.fileName,i+=h.text;const o=i.trim().split("\n"),s=[];for(let p=1;p<o.length;p++){const m=o[p].trim().split(","),y=parseInt(m[0]),f=m[1];s.push(y,f)}const l=[];128==s.length&&(l.push(s[0],s[1],s[126],s[127],s[62],s[63],s[64],s[65],s[30],s[31],s[96],s[97],s[32],s[33],s[94],s[95],s[14],s[15],s[112],s[113],s[48],s[49],s[78],s[79],s[16],s[17],s[110],s[111],s[46],s[47],s[80],s[81],s[6],s[7],s[120],s[121],s[56],s[57],s[70],s[71],s[24],s[25],s[102],s[103],s[38],s[39],s[88],s[89],s[8],s[9],s[118],s[119],s[54],s[55],s[72],s[73],s[22],s[23],s[104],s[105],s[40],s[41],s[86],s[87],s[2],s[3],s[124],s[125],s[60],s[61],s[66],s[67],s[28],s[29],s[98],s[99],s[34],s[35],s[92],s[93],s[12],s[13],s[114],s[115],s[50],s[51],s[76],s[77],s[18],s[19],s[108],s[109],s[44],s[45],s[82],s[83],s[4],s[5],s[122],s[123],s[58],s[59],s[68],s[69],s[26],s[27],s[100],s[101],s[36],s[37],s[90],s[91],s[10],s[11],s[58],s[59],s[52],s[53],s[74],s[75],s[10],s[21],s[106],s[107],s[42],s[43],s[84],s[85]),console.log("size 64")),64==s.length&&(l.push(s[0],s[1],s[62],s[63],s[30],s[31],s[32],s[33],s[16],s[17],s[46],s[47],s[14],s[15],s[48],s[49],s[6],s[7],s[56],s[57],s[24],s[25],s[38],s[39],s[22],s[23],s[40],s[41],s[8],s[9],s[54],s[55],s[2],s[3],s[60],s[61],s[28],s[29],s[34],s[35],s[18],s[19],s[44],s[45],s[12],s[13],s[50],s[51],s[4],s[5],s[58],s[59],s[26],s[27],s[36],s[37],s[20],s[21],s[42],s[43],s[10],s[11],s[52],s[53]),console.log("size 32")),32==s.length&&(l.push(s[0],s[1],s[30],s[31],s[14],s[15],s[16],s[17],s[8],s[9],s[22],s[23],s[6],s[7],s[24],s[25],s[10],s[11],s[20],s[21],s[4],s[5],s[26],s[27],s[12],s[13],s[18],s[19],s[2],s[3],s[28],s[29]),console.log("size 16")),32==s.length&&(l.push(s[0],s[1],s[14],s[15],s[6],s[7],s[8],s[9],s[4],s[5],s[10],s[11],s[2],s[3],s[12],s[13]),console.log("size 8")),8==s.length&&(l.push(s[0],s[1],s[6],s[7],s[2],s[3],s[4],s[5]),console.log("size 4")),4==s.length&&(l.push(s[0],s[1],s[2],s[3]),console.log("size 2")),console.log(l);let c=0,d=s.length/2,u=Math.log2(d);if(await t.confirm(`Bracket size is set to ${d}, do you want to create a new page with a ${d}-team bracket?`,"Bracket Size","Yes","No")){const g=r.addPage({title:"Bracket"});n.setCurrentPage(g);const{x:S,y:C}=n.getVisibleRect();let T,b,v;switch(d){case 64:T=[0,90,200,480,940,2010,980],b=[0,400,800,1200,1600,2e3,2500],v=[110,300,680,1435,2980,1e3];break;case 32:T=[0,90,200,480,940,525],b=[0,400,800,1200,1600,2e3],v=[110,300,680,1435,1e3];break;case 16:T=[0,90,200,480,250],b=[0,400,800,1200,1600],v=[110,300,680,1e3];break;case 8:T=[0,90,200,140],b=[0,400,800,1200],v=[110,300,680,1e3];break;case 4:T=[0,90,45],b=[0,400,800],v=[110,300,680];break;case 2:T=[0,45],b=[0,400],v=[110];break;default:T=[],b=[],v=[]}const P=await t.getCustomShapeDefinition("test","first");if(P&&console.log("custom shape loaded"),!P)return void console.log("custom shape not loaded");let x;x=[];for(let w=0;w<u+1;w++){let E=b[w];for(let k=1;k<=d/2**w;k++){const O=0===w?`${l[2*(k-1)]} - ${l[2*(k-1)+1]}`:"TBD";P.boundingBox.x=S+E,P.boundingBox.y=C+c+T[w];const A=g.addBlock(P),F=A.textAreas.keys()[0];A.textAreas.set(F,O),x.push(A),c+=k%2==0?v[w]:80}c=T[w]}function D(){let e=0,t=x.length,i=d;for(;e+i<=t;){let n=e+i,r=i/2;for(let r=0;r<i;r+=2)e+r+1<n&&n+r/2<t&&a(x[e+r+1],x[n+r/2]);e=n,i=r}}D()}}(e)})),async function(){const i=new e.Menu(t);i.addDropdownMenuItem({label:"Create bracket with CSV file",file:{action:"create-bracket",accept:"text/csv",singleFileOnly:!0,binary:!0}}),i.addDropdownMenuItem({label:"Create bracket with user input",action:"custom-bracket"})}()})()})();